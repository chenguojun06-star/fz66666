<view class="login-page">
  <!-- å¤©èåº§æ˜Ÿåº§å‘¼å¸ç¯è£…é¥° -->
  <view class="login-constellation" aria-hidden="true">
    <view class="constellation-line"></view>
    <view class="constellation-glow"></view>
    <view class="constellation-dot" style="left:48rpx;top:50rpx;"></view>
    <view class="constellation-dot" style="left:96rpx;top:100rpx;"></view>
    <view class="constellation-dot" style="left:136rpx;top:146rpx;"></view>
    <view class="constellation-dot" style="left:182rpx;top:124rpx;"></view>
    <view class="constellation-dot" style="left:230rpx;top:156rpx;"></view>
    <view class="constellation-dot" style="left:270rpx;top:196rpx;"></view>
    <view class="constellation-dot" style="left:310rpx;top:174rpx;"></view>
    <view class="constellation-dot" style="left:342rpx;top:218rpx;"></view>
    <view class="constellation-dot" style="left:366rpx;top:240rpx;"></view>
  </view>

  <view class="login-content">
    <!-- é¡¶éƒ¨å·¥å‚åç§°ï¼ˆå±…ä¸­å¤§å­—ï¼‰ -->
    <view class="login-header">
      <text class="login-title">{{selectedTenantName || 'äº‘è£³æ™ºé“¾'}}</text>
    </view>

    <!-- æ­£åœ¨éªŒè¯å¾®ä¿¡èº«ä»½ï¼ˆopenid check loadingï¼‰ -->
    <view wx:if="{{wechatChecking}}" class="wechat-checking">
      <view class="wechat-checking-icon">å¾®ä¿¡</view>
      <text class="wechat-checking-text">æ­£åœ¨éªŒè¯å¾®ä¿¡èº«ä»½...</text>
    </view>

    <!-- ç™»å½•è¡¨å•ï¼ˆopenid æœªç»‘å®šæ—¶ / å¼€å‘ç¯å¢ƒï¼‰ -->
    <block wx:if="{{!wechatChecking}}">

    <!-- é‚€è¯·æ¨ªå¹…ï¼šç®¡ç†å‘˜æ‰«ç é‚€è¯·å‘˜å·¥æ—¶æ˜¾ç¤º -->
    <view wx:if="{{inviteBanner}}" class="invite-banner">
      <text class="invite-banner-icon">ğŸ‰</text>
      <text class="invite-banner-text">{{inviteBanner}}</text>
    </view>

    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> å…¬å¸</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ”</text>
        <input
          class="login-input"
          placeholder="{{tenantsLoading ? 'åŠ è½½ä¸­...' : 'è¾“å…¥å…¬å¸åç§°æœç´¢'}}"
          value="{{tenantSearchText}}"
          bindinput="onTenantSearch"
          bindfocus="onTenantSearchFocus"
          disabled="{{loading || tenantsLoading || inviteTenantFixed}}"
        />
        <text wx:if="{{selectedTenantName && !inviteTenantFixed}}" class="login-input-clear" bindtap="onClearTenant">âœ•</text>
      </view>
      <view wx:if="{{selectedTenantName}}" class="tenant-selected-tag">âœ“ å·²é€‰æ‹©ï¼š{{selectedTenantName}}</view>
      <!-- æœç´¢ç»“æœä¸‹æ‹‰ -->
      <view wx:if="{{showTenantResults && filteredTenants.length > 0}}" class="tenant-results">
        <view
          wx:for="{{filteredTenants}}"
          wx:key="id"
          class="tenant-result-item"
          data-index="{{index}}"
          bindtap="onTenantSelect"
          hover-class="tenant-result-item-hover"
          hover-stay-time="50"
        >{{item.tenantName}}</view>
      </view>
      <view wx:if="{{showTenantResults && filteredTenants.length === 0 && tenantSearchText}}" class="tenant-results">
        <view class="tenant-result-empty">æœªæ‰¾åˆ°åŒ¹é…çš„å…¬å¸</view>
      </view>
    </view>

    <!-- ç”¨æˆ·å -->
    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> ç”¨æˆ·å</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ‘¤</text>
        <input
          class="login-input"
          placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
          value="{{username}}"
          bindinput="onUsernameInput"
          disabled="{{loading}}"
        />
      </view>
    </view>

    <!-- å¯†ç  -->
    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> å¯†ç </view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ”’</text>
        <input
          class="login-input"
          placeholder="è¯·è¾“å…¥å¯†ç "
          password="{{!showPassword}}"
          value="{{password}}"
          bindinput="onPasswordInput"
          disabled="{{loading}}"
        />
        <text class="login-input-eye" bindtap="togglePassword">{{showPassword ? 'ğŸ™ˆ' : 'ğŸ‘'}}</text>
      </view>
    </view>

    <!-- ç™»å½•æŒ‰é’® -->
    <view class="login-btn-wrap">
      <view class="login-btn {{loading || !selectedTenantId ? 'login-btn-disabled' : ''}}" bindtap="onLogin" hover-class="login-btn-hover" hover-stay-time="50">
        {{loading ? 'ç™»å½•ä¸­...' : 'ç™» å½•'}}
      </view>
    </view>

    <!-- å¾®ä¿¡ä¸€é”®ç™»å½• -->
    <view class="login-btn-wrap" wx:if="{{!showDevFields}}">
      <view class="login-btn-wechat {{loading || !selectedTenantId ? 'login-btn-disabled' : ''}}" bindtap="onWechatLogin" hover-class="login-btn-wechat-hover" hover-stay-time="50">
        {{loading ? 'ç™»å½•ä¸­...' : 'å¾®ä¿¡ä¸€é”®ç™»å½•'}}
      </view>
    </view>

    <!-- å¼€å‘æ¨¡å¼ï¼šæœåŠ¡å™¨åœ°å€ -->
    <view wx:if="{{showDevFields}}" class="login-field login-field-dev">
      <view class="login-label">æœåŠ¡å™¨åœ°å€</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸŒ</text>
        <input
          class="login-input"
          placeholder="ä¾‹å¦‚ï¼šhttp://192.168.1.10:8088"
          value="{{apiBaseUrl}}"
          bindinput="onApiBaseUrlInput"
        />
      </view>
    </view>

    <!-- æ³¨å†Œå…¥å£ -->
    <view class="login-register-section">
      <view class="login-register-link" bindtap="onManualRegister" hover-class="login-register-link-hover" hover-stay-time="50">è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ</view>
    </view>

    <!-- åº•éƒ¨ç‰ˆæƒ -->
    <view class="login-footer">Â© 2026 äº‘è£³æ™ºé“¾</view>
    </block><!-- /!wechatChecking -->
  </view>
</view>
