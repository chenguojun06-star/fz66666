<view class="login-page">
  <view class="login-lang-corner" bindtap="onLanguageSwitchTap">
    <text class="login-lang-icon">ğŸŒ</text>
    <text class="login-lang-text">{{currentLanguageLabel}}</text>
  </view>

  <!-- å¤©èåº§æ˜Ÿåº§å‘¼å¸ç¯è£…é¥° -->
  <view class="login-constellation" aria-hidden="true">
    <view class="constellation-line"></view>
    <view class="constellation-glow"></view>
    <view class="constellation-dot" style="left:48rpx;top:50rpx;"></view>
    <view class="constellation-dot" style="left:96rpx;top:100rpx;"></view>
    <view class="constellation-dot" style="left:136rpx;top:146rpx;"></view>
    <view class="constellation-dot" style="left:182rpx;top:124rpx;"></view>
    <view class="constellation-dot" style="left:230rpx;top:156rpx;"></view>
    <view class="constellation-dot" style="left:270rpx;top:196rpx;"></view>
    <view class="constellation-dot" style="left:310rpx;top:174rpx;"></view>
    <view class="constellation-dot" style="left:342rpx;top:218rpx;"></view>
    <view class="constellation-dot" style="left:366rpx;top:240rpx;"></view>
  </view>

  <view class="login-content">
    <!-- é¡¶éƒ¨å·¥å‚åç§°ï¼ˆå±…ä¸­å¤§å­—ï¼‰ -->
    <view class="login-header">
      <text class="login-title">{{selectedTenantName || i18nTexts.brand}}</text>
    </view>

    <!-- æ­£åœ¨éªŒè¯å¾®ä¿¡èº«ä»½ï¼ˆopenid check loadingï¼‰ -->
    <view wx:if="{{wechatChecking}}" class="wechat-checking">
      <view class="wechat-checking-icon">å¾®ä¿¡</view>
      <text class="wechat-checking-text">{{i18nTexts.wechatChecking}}</text>
    </view>

    <!-- ç™»å½•è¡¨å•ï¼ˆopenid æœªç»‘å®šæ—¶ / å¼€å‘ç¯å¢ƒï¼‰ -->
    <block wx:if="{{!wechatChecking}}">

    <!-- é‚€è¯·æ¨ªå¹…ï¼šç®¡ç†å‘˜æ‰«ç é‚€è¯·å‘˜å·¥æ—¶æ˜¾ç¤º -->
    <view wx:if="{{inviteBanner}}" class="invite-banner">
      <text class="invite-banner-icon">ğŸ‰</text>
      <text class="invite-banner-text">{{inviteBanner}}</text>
    </view>

    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> {{i18nTexts.company}}</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ”</text>
        <input
          class="login-input"
          placeholder="{{tenantsLoading ? i18nTexts.loading : i18nTexts.companySearchPlaceholder}}"
          value="{{tenantSearchText}}"
          bindinput="onTenantSearch"
          bindfocus="onTenantSearchFocus"
          disabled="{{loading || tenantsLoading || inviteTenantFixed}}"
        />
        <text wx:if="{{selectedTenantName && !inviteTenantFixed}}" class="login-input-clear" bindtap="onClearTenant">âœ•</text>
      </view>
      <view wx:if="{{selectedTenantName}}" class="tenant-selected-tag">{{i18nTexts.companySelectedPrefix}}{{selectedTenantName}}</view>
      <!-- æœç´¢ç»“æœä¸‹æ‹‰ -->
      <view wx:if="{{showTenantResults && filteredTenants.length > 0}}" class="tenant-results">
        <view
          wx:for="{{filteredTenants}}"
          wx:key="id"
          class="tenant-result-item"
          data-index="{{index}}"
          bindtap="onTenantSelect"
          hover-class="tenant-result-item-hover"
          hover-stay-time="50"
        >{{item.tenantName}}</view>
      </view>
      <view wx:if="{{showTenantResults && filteredTenants.length === 0 && tenantSearchText}}" class="tenant-results">
        <view class="tenant-result-empty">{{i18nTexts.companyNotFound}}</view>
      </view>
    </view>

    <!-- ç”¨æˆ·å -->
    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> {{i18nTexts.username}}</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ‘¤</text>
        <input
          class="login-input"
          placeholder="{{i18nTexts.usernamePlaceholder}}"
          value="{{username}}"
          bindinput="onUsernameInput"
          disabled="{{loading}}"
        />
      </view>
    </view>

    <!-- å¯†ç  -->
    <view class="login-field">
      <view class="login-label"><text class="login-label-required">*</text> {{i18nTexts.password}}</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸ”’</text>
        <input
          class="login-input"
          placeholder="{{i18nTexts.passwordPlaceholder}}"
          password="{{!showPassword}}"
          value="{{password}}"
          bindinput="onPasswordInput"
          disabled="{{loading}}"
        />
        <text class="login-input-eye" bindtap="togglePassword">{{showPassword ? 'ğŸ™ˆ' : 'ğŸ‘'}}</text>
      </view>
    </view>

    <!-- ç™»å½•æŒ‰é’® -->
    <view class="login-btn-wrap">
      <view class="login-btn {{loading || !selectedTenantId ? 'login-btn-disabled' : ''}}" bindtap="onLogin" hover-class="login-btn-hover" hover-stay-time="50">
        {{loading ? i18nTexts.submitting : i18nTexts.submit}}
      </view>
    </view>

    <!-- å¾®ä¿¡ä¸€é”®ç™»å½• -->
    <view class="login-btn-wrap" wx:if="{{!showDevFields}}">
      <view class="login-btn-wechat {{loading || !selectedTenantId ? 'login-btn-disabled' : ''}}" bindtap="onWechatLogin" hover-class="login-btn-wechat-hover" hover-stay-time="50">
        {{loading ? i18nTexts.submitting : i18nTexts.wechatQuickLogin}}
      </view>
    </view>

    <!-- å¼€å‘æ¨¡å¼ï¼šæœåŠ¡å™¨åœ°å€ -->
    <view wx:if="{{showDevFields}}" class="login-field login-field-dev">
      <view class="login-label">{{i18nTexts.serverUrl}}</view>
      <view class="login-input-wrap">
        <text class="login-input-icon">ğŸŒ</text>
        <input
          class="login-input"
          placeholder="{{i18nTexts.serverUrlPlaceholder}}"
          value="{{apiBaseUrl}}"
          bindinput="onApiBaseUrlInput"
        />
      </view>
    </view>

    <!-- æ³¨å†Œå…¥å£ -->
    <view class="login-register-section">
      <view class="login-register-link" bindtap="onManualRegister" hover-class="login-register-link-hover" hover-stay-time="50">{{i18nTexts.noAccount}}{{i18nTexts.registerNow}}</view>
    </view>

    <!-- åº•éƒ¨ç‰ˆæƒ -->
    <view class="login-footer">Â© 2026 {{i18nTexts.brand}}</view>
    </block><!-- /!wechatChecking -->
  </view>
</view>
