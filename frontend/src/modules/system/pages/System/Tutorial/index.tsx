import React, { useState, useEffect } from 'react';
import {
  Card,
  Collapse,
  Steps,
  Typography,
  Space,
  Tag,
  Image,
  Empty,
  Button,
  Row,
  Col,
  Tabs,
  Alert,
  Timeline,
  Badge,
} from 'antd';
import {
  BookOutlined,
  QuestionCircleOutlined,
  RocketOutlined,
  FileTextOutlined,
  VideoCameraOutlined,
  BulbOutlined,
  ThunderboltOutlined,
} from '@ant-design/icons';
import StandardSearchBar from '@/components/common/StandardSearchBar';
import Layout from '@/components/Layout';
import './style.css';
import type { Dayjs } from 'dayjs';

const { Title, Text, Paragraph } = Typography;

/** 根据 URL 形态渲染视频播放器 */
const VideoPlayerBlock: React.FC<{ url: string }> = ({ url }) => {
  const u = url.trim();

  // Bilibili：支持 BV 号
  const bvMatch = u.match(/bilibili\.com\/video\/(BV[\w]+)/i);
  if (bvMatch) {
    return (
      <div style={{ position: 'relative', paddingBottom: '56.25%', height: 0, overflow: 'hidden' }}>
        <iframe
          src={`//player.bilibili.com/player.html?bvid=${bvMatch[1]}&page=1&high_quality=1&danmaku=0`}
          style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', border: 'none' }}
          allowFullScreen
          title="视频教程"
        />
      </div>
    );
  }

  // YouTube
  const ytMatch = u.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)?([\w-]{11})/);
  if (u.includes('youtube.com') || u.includes('youtu.be')) {
    const vid = ytMatch ? ytMatch[1] : '';
    return (
      <div style={{ position: 'relative', paddingBottom: '56.25%', height: 0, overflow: 'hidden' }}>
        <iframe
          src={`https://www.youtube.com/embed/${vid}`}
          style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', border: 'none' }}
          allowFullScreen
          title="视频教程"
        />
      </div>
    );
  }

  // 直链 MP4 / WebM
  if (/\.(mp4|webm|mov)(\?.*)?$/i.test(u)) {
    return (
      <video
        src={u}
        controls
        style={{ width: '100%', maxHeight: 480, background: '#000', display: 'block', borderRadius: 6 }}
        preload="metadata"
      >
        您的浏览器不支持 video 标签，请
        <a href={u} target="_blank" rel="noopener noreferrer">点击下载观看</a>。
      </video>
    );
  }

  // 其他链接：直接显示可点击链接
  return (
    <Space direction="vertical" style={{ width: '100%' }}>
      <Alert
        type="info"
        showIcon
        description={
          <>
            视频链接：
            <a href={u} target="_blank" rel="noopener noreferrer">{u}</a>
          </>
        }
      />
      <Button type="primary" onClick={() => window.open(u, '_blank')}>
        🎬 点击播放视频
      </Button>
    </Space>
  );
};

interface TutorialStep {
  title: string;
  description: string;
  image?: string;
  tips?: string[];
}

interface Tutorial {
  id: string;
  title: string;
  category: string;
  difficulty: 'beginner' | 'intermediate' | 'advanced';
  duration: string;
  steps: TutorialStep[];
  videoUrl?: string;
  faqs?: { question: string; answer: string }[];
  tags: string[];
}

const SystemTutorial: React.FC = () => {
  const [searchText, setSearchText] = useState('');
  const [activeCategory, setActiveCategory] = useState<string>('all');
  const [dateRange, setDateRange] = useState<[Dayjs | null, Dayjs | null] | null>(null);
  const [filteredTutorials, setFilteredTutorials] = useState<Tutorial[]>([]);

  // 教程数据
  const tutorials: Tutorial[] = [
    {
      id: 'order-create',
      title: '生产订单创建完整流程',
      category: 'production',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['订单管理', '生产', '入门必看'],
      steps: [
        {
          title: '进入订单管理页面',
          description: '从左侧菜单选择「订单管理」→「我的订单」，进入订单列表页面。',
          tips: [
            '确保你有「订单管理」权限，如无权限请联系管理员',
            '首次使用建议先查看「款式资料」确保有可用款式',
          ],
        },
        {
          title: '点击新建订单',
          description: '点击页面右上角的「+ 新建订单」按钮，打开订单创建弹窗。',
          tips: ['弹窗为标准尺寸（大60vw/中40vw/小30vw），可拖拽调整大小'],
        },
        {
          title: '选择款式',
          description: '在款式选择下拉框中搜索或选择已存在的款式，系统会自动填充款式信息（款号、颜色、尺码）。',
          tips: [
            '款式必须已在「款式资料」中创建',
            '款式封面图会自动显示，帮助确认选择',
            '如找不到款式，请先去「款式资料」创建',
          ],
        },
        {
          title: '填写订单基本信息',
          description: '填写订单编号（可自动生成）、客户名称、交货日期等必填字段。',
          tips: [
            '订单编号格式：PO + 8位日期 + 3位序号（如 PO20260128001）',
            '交货日期建议预留充足时间（建议至少30天）',
            '订单数量会影响后续裁剪分菲数量',
          ],
        },
        {
          title: '配置SKU明细',
          description: '在SKU明细表格中，为每个颜色和尺码组合设置订单数量。系统支持批量导入或手动输入。',
          tips: [
            'SKU = 款号 + 颜色 + 尺码',
            '总数量会自动汇总显示',
            '可以使用Excel批量导入（参考模板）',
          ],
        },
        {
          title: '保存并生成二维码',
          description: '点击「保存」后，系统会生成订单二维码，用于后续扫码生产。',
          tips: [
            '二维码包含订单完整信息',
            '建议打印二维码贴在生产单据上',
            '小程序扫码可直接进入生产工序',
          ],
        },
      ],
      faqs: [
        {
          question: '订单创建后可以修改吗？',
          answer: '✅ 可以修改。\n\n操作步骤：\n1. 进入【订单管理】→【我的订单】\n2. 找到目标订单，点击右侧【编辑】按钮\n3. 修改需要调整的字段（数量、交期等）\n4. 点击【保存】完成修改\n\n⚠️ 注意事项：\n• 已开始生产的订单谨慎修改数量，可能影响裁剪和工序进度\n• 修改交期需提前与工厂沟通确认\n• 重大变更建议创建新订单，避免数据混乱',
        },
        {
          question: '为什么找不到某个款式？',
          answer: '❌ 款式未创建或未完成必要配置。\n\n解决步骤：\n1. 进入【款式资料】页面\n2. 点击【新建款式】按钮\n3. 填写款号、名称、颜色、尺码等基本信息\n4. 上传款式图片和放码纸样（.dxf/.plt/.ets格式）\n5. 保存后即可在订单中选择\n\n⚠️ 关键要求：\n• 必须上传放码纸样才能用于生产订单\n• 款号不能重复，建议统一编码规则\n• 颜色和尺码需提前在【字典管理】配置',
        },
        {
          question: 'SKU数量配置有什么规则？',
          answer: '📊 SKU = 款号 + 颜色 + 尺码，每个组合独立配置数量。\n\n配置规则：\n1. 单个SKU数量必须 > 0（不能为空或负数）\n2. 所有SKU数量之和 = 订单总数量\n3. 系统自动计算总数并实时显示\n4. 支持Excel批量导入（下载模板填写）\n\n⚠️ 常见错误：\n• 总数不一致：检查是否有SKU遗漏或重复\n• 数量过大：单个SKU建议 < 1000件，超大订单分批\n• 尺码缺失：确保所有尺码都已配置（S/M/L/XL/XXL）',
        },
      ],
      videoUrl: 'https://example.com/tutorial-order-create.mp4',
    },
    {
      id: 'cutting-task',
      title: '裁剪单生成与菲号管理',
      category: 'production',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['裁剪', '菲号', '生产'],
      steps: [
        {
          title: '从订单创建裁剪单',
          description: '在「生产管理」→「裁剪单」页面，选择已创建的生产订单，点击「生成裁剪单」。',
          tips: [
            '订单必须有完整的SKU配置',
            '系统会根据订单数量自动计算裁剪份数',
          ],
        },
        {
          title: '配置裁剪明细',
          description: '设置每个菲号的数量、颜色、尺码分布。菲号格式为：订单号 + 颜色 + 序号（如 PO20260128001-黑色-01）。',
          tips: [
            '菲号是裁剪和扫码的最小单位',
            '建议每个菲号控制在50-100件',
            '相同颜色的菲号需要连续编号',
          ],
        },
        {
          title: '生成裁剪二维码',
          description: '保存后系统自动生成每个菲号的二维码，可批量打印贴在裁片上。',
          tips: [
            '每个菲号有独立二维码',
            '扫码时会自动识别菲号和SKU信息',
            '二维码支持多种格式打印（PDF/图片）',
          ],
        },
        {
          title: '下发裁剪任务',
          description: '将裁剪单分配给对应工厂或裁剪组，开始裁剪工作。',
          tips: ['可设置裁剪优先级', '支持多工厂并行裁剪'],
        },
      ],
      faqs: [
        {
          question: '菲号数量如何确定？',
          answer: '📐 菲号数量 = 订单总量 ÷ 每菲标准数量。\n\n计算示例：\n• 订单500件，每菲100件 → 生成5个菲号\n• 订单380件，每菲100件 → 生成4个菲号（最后一个80件）\n\n系统建议：\n1. 小订单（< 200件）：每菲50-80件\n2. 中订单（200-1000件）：每菲80-100件\n3. 大订单（> 1000件）：每菲100-150件\n\n⚠️ 注意事项：\n• 每菲数量尽量一致，便于工序统计\n• 最后一菲允许数量不足，系统自动补齐\n• 不同颜色分开编号（黑色-01、黑色-02 | 白色-01、白色-02）',
        },
        {
          question: '裁剪单可以重复生成吗？',
          answer: '✅ 可以分批生成多个裁剪单。\n\n适用场景：\n1. 大订单分期生产（如1000件分2批，每批500）\n2. 物料分批到货，裁剪分批进行\n3. 多工厂并行生产，每厂独立裁剪单\n\n操作步骤：\n1. 进入【裁剪单】页面，选择同一订单\n2. 点击【生成裁剪单】，填写本批次数量\n3. 系统自动分配剩余菲号编号（如第二批从-06开始）\n4. 保存后生成新裁剪单和二维码\n\n⚠️ 关键提示：\n• 多批次菲号编号连续，避免重复\n• 总裁剪数量不能超过订单数量\n• 建议备注批次信息（如"第1批/共2批"）',
        },
      ],
      videoUrl: 'https://example.com/tutorial-cutting.mp4',
    },
    {
      id: 'scan-work',
      title: '小程序扫码工序操作',
      category: 'mobile',
      difficulty: 'beginner',
      duration: '6分钟',
      tags: ['小程序', '扫码', '工序'],
      steps: [
        {
          title: '打开小程序扫码页面',
          description: '在微信小程序首页点击「扫码工序」快捷入口，或从底部菜单进入「工序扫码」。',
          tips: ['首次使用需要授权摄像头权限', '确保网络畅通'],
        },
        {
          title: '扫描菲号二维码',
          description: '对准裁剪单上的菲号二维码扫描，系统自动识别菲号信息（订单号 + 颜色 + 菲号序号）。',
          tips: [
            '扫码距离建议10-30cm',
            '确保二维码清晰无污损',
            '扫描成功会震动提示',
          ],
        },
        {
          title: '智能工序识别',
          description: '系统根据扫码次数自动识别当前工序（第1次=做领，第2次=上领...），无需手动选择。',
          tips: [
            '工序顺序由订单配置决定',
            '每次扫码间隔有防重复保护（最少30秒）',
            '如需跳过工序，可手动切换',
          ],
        },
        {
          title: '确认提交',
          description: '确认工序信息和数量后，点击「提交」完成本次扫码。系统自动记录工人、时间、工序。',
          tips: [
            '提交成功后会显示当前进度',
            '工资自动按工序单价计算',
            '可查看历史扫码记录',
          ],
        },
      ],
      faqs: [
        {
          question: '扫码后为什么提示"请稍后再试"？',
          answer: '⏰ 防重复保护机制触发。\n\n间隔时间计算：\n最小间隔 = max(30秒, 菲号数量 × 工序分钟 × 60 × 50%)\n\n示例：\n• 菲号100件，做领3分钟/件 → 间隔 = max(30秒, 100×3×60×50%) = 9000秒 ≈ 2.5小时\n• 菲号50件，上领2分钟/件 → 间隔 = max(30秒, 50×2×60×50%) = 3000秒 ≈ 50分钟\n\n解决方法：\n1. 等待间隔时间后重试\n2. 确认上次扫码是否成功（查看历史记录）\n3. 如确认误判，联系管理员后台调整\n\n⚠️ 为什么有保护：\n• 避免重复计算工资\n• 防止误扫导致数据错误\n• 确保工序实际完成才能扫码',
        },
        {
          question: '扫错工序怎么办？',
          answer: '🔄 分提交前和提交后两种情况。\n\n提交前处理：\n1. 扫码后在确认页面检查工序名称\n2. 如有误，点击工序名称手动切换\n3. 选择正确工序后再点击【提交】\n\n提交后处理：\n1. 立即截图保存错误记录（工序、时间、数量）\n2. 联系车间主管或管理员\n3. 管理员在PC端【扫码记录】页面找到该记录\n4. 点击【撤销】或【修改工序】\n5. 重新扫码提交正确工序\n\n⚠️ 重要提示：\n• 提交前务必核对工序名称\n• 发现错误第一时间处理，避免影响工资结算\n• 频繁出错需检查二维码是否正确或培训操作流程',
        },
        {
          question: '三种扫码模式有什么区别？',
          answer: '📱 三种模式适用不同场景。\n\n1️⃣ 订单扫码（扫订单号）：\n• 扫描内容：PO20260128001\n• 显示：SKU明细表单\n• 适用：批量提交多个SKU\n• 优点：一次扫码处理整个订单\n• 缺点：需手动选择数量，操作慢\n\n2️⃣ 菲号扫码（推荐⭐）：\n• 扫描内容：PO20260128001-黑色-01\n• 显示：自动识别菲号信息\n• 适用：单个菲号工序提交\n• 优点：自动识别，直接确认，最快\n• 缺点：需为每个菲号打印二维码\n\n3️⃣ SKU扫码（扫JSON）：\n• 扫描内容：{"orderNo":"PO...","color":"黑色","size":"L"}\n• 显示：单个SKU信息\n• 适用：特殊场景或测试\n• 优点：精确到单个SKU\n• 缺点：二维码复杂，少用\n\n⚠️ 建议：\n99%的场景使用菲号扫码，速度最快最准确！',
        },
      ],
    },
    {
      id: 'quality-check',
      title: '质检入库完整流程',
      category: 'production',
      difficulty: 'intermediate',
      duration: '7分钟',
      tags: ['质检', '入库', '仓储'],
      steps: [
        {
          title: '进入质检入库页面',
          description: '从「生产管理」→「质检入库」进入，查看待质检的生产订单。',
          tips: ['只显示已完成生产的订单', '可按工厂筛选'],
        },
        {
          title: '创建质检记录',
          description: '选择订单后，填写质检信息：合格数量、不良数量、不良原因等。',
          tips: [
            '合格数量 + 不良数量 = 完成数量',
            '不良品需要详细备注原因',
            '支持拍照记录质检问题',
          ],
        },
        {
          title: '生成入库单',
          description: '质检通过后，系统自动生成成品入库单，分配库位。',
          tips: [
            '入库单号自动生成（WH + 日期 + 序号）',
            '可设置库位编号便于管理',
            '入库后库存实时更新',
          ],
        },
        {
          title: '打印入库凭证',
          description: '打印入库单和库位标签，贴在成品包装上。',
          tips: ['支持批量打印', '包含二维码便于出库扫描'],
        },
      ],
      faqs: [
        {
          question: '质检不合格的产品如何处理？',
          answer: '❌ 不合格品分返工和报废两种处理。\n\n返工流程：\n1. 质检页面填写【不良数量】和【不良原因】（如线头、色差）\n2. 拍照上传不良品照片（必须）\n3. 选择【返工处理】，系统自动生成返工任务\n4. 返工任务下发给原工厂或指定车间\n5. 返工完成后重新质检入库\n\n报废流程：\n1. 质检页面选择【报废处理】\n2. 填写报废原因（如严重质量问题、无法修复）\n3. 上传报废照片和主管审批签字\n4. 系统扣减订单完成数量\n5. 财务自动生成报废损失单\n\n⚠️ 注意事项：\n• 返工率 > 5%需调查根本原因\n• 报废需主管以上权限审批\n• 不良原因详细记录，便于后续改进',
        },
        {
          question: '入库后发现质量问题怎么办？',
          answer: '🔍 入库后质量问题需紧急处理。\n\n操作步骤：\n1. 进入【仓储管理】→【库存查询】\n2. 搜索问题批次（按入库单号或订单号）\n3. 点击【标记异常】，选择"待处理"状态\n4. 填写问题描述和发现人\n5. 系统自动锁定该批次库存（暂停出库）\n\n后续处理：\n方案1 - 复核质检：\n• 创建【质检复核任务】\n• 重新抽检或全检\n• 合格则解除锁定，不合格转返工/报废\n\n方案2 - 客户已发货：\n• 立即联系物流拦截\n• 无法拦截则准备补发或赔偿\n• 记录客诉，追溯责任人\n\n⚠️ 预防措施：\n• 质检时严格按标准执行\n• 入库前再次抽检关键部位\n• 定期培训质检人员提升水平',
        },
      ],
    },
    {
      id: 'material-in-out',
      title: '面辅料出入库管理',
      category: 'warehouse',
      difficulty: 'beginner',
      duration: '6分钟',
      tags: ['仓储', '物料', '入库', '出库'],
      steps: [
        {
          title: '物料采购入库',
          description: '从「生产管理」→「物料采购」创建采购单，供应商送货后进行入库操作。',
          tips: [
            '入库前需要核对采购单信息',
            '检查物料规格、数量、质量',
            '拍照记录物料状态',
          ],
        },
        {
          title: '填写入库信息',
          description: '扫描或输入采购单号，填写实际到货数量、检验结果、存放库位。',
          tips: [
            '实际数量可能与采购数量不同，需要备注差异原因',
            '库位编号建议按区域-货架-层-位格式（如A-01-02-03）',
            '支持批次管理，同一物料不同批次分开存放',
          ],
        },
        {
          title: '物料出库发放',
          description: '生产领料时，根据生产订单或裁剪单进行物料出库，扣减库存。',
          tips: [
            '出库需要生产单据支撑',
            '按先进先出原则发放',
            '出库后更新库存台账',
          ],
        },
        {
          title: '库存盘点',
          description: '定期进行库存盘点，核对系统库存与实物库存，处理差异。',
          tips: ['建议每月盘点一次', '盘点时暂停出入库', '差异超过5%需要调查原因'],
        },
      ],
      faqs: [
        {
          question: '如何查询某个物料的库存？',
          answer: '📊 多维度查询实时库存。\n\n查询步骤：\n1. 进入【仓储管理】→【库存查询】\n2. 选择查询条件：\n   • 物料编号：输入完整编码（如F001）\n   • 物料名称：模糊搜索（如"面料"）\n   • 物料类别：下拉选择（面料/辅料/配件）\n   • 供应商：筛选特定供应商物料\n3. 点击【查询】，查看结果列表\n\n库存状态说明：\n• 可用库存：可立即领用的数量\n• 在途库存：已下单未到货的数量\n• 锁定库存：已分配给订单但未出库\n• 安全库存：最低库存警戒线\n\n⚠️ 快捷操作：\n• 扫描物料二维码快速查询\n• 导出Excel做库存分析\n• 设置库存预警（低于安全库存自动提醒）',
        },
        {
          question: '物料过期或损坏如何处理？',
          answer: '🗑️ 过期/损坏物料需及时处理避免损失。\n\n报废处理：\n1. 进入【库存管理】，找到问题物料\n2. 点击【标记异常】→【待处理】\n3. 拍照记录损坏情况（必须）\n4. 填写报废申请单：\n   • 报废原因（过期/损坏/质量不合格）\n   • 报废数量和金额\n   • 责任归属（供应商/仓管/使用部门）\n5. 提交主管审批\n6. 审批通过后系统自动扣减库存\n7. 财务生成报废损失凭证\n\n退货处理（供应商责任）：\n1. 联系供应商协商退货\n2. 创建【退货出库单】\n3. 扫码出库，系统扣减库存\n4. 供应商确认后财务退款\n\n⚠️ 预防措施：\n• 物料入库严格检验质量\n• 标注保质期，临期物料优先使用\n• 定期盘点，及时发现问题物料',
        },
      ],
    },
    {
      id: 'finished-product-out',
      title: '成品出库发货流程',
      category: 'warehouse',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['成品', '出库', '发货', '物流'],
      steps: [
        {
          title: '创建出库单',
          description: '从「仓储管理」→「成品出库」创建出库单，选择订单和出库数量。',
          tips: [
            '出库数量不能超过库存数量',
            '可部分出库（分批发货）',
            '自动关联销售订单',
          ],
        },
        {
          title: '扫码拣货',
          description: '根据出库单到对应库位扫描成品二维码，确认拣货。',
          tips: [
            '支持小程序扫码拣货',
            '拣货完成后自动核销出库单',
            '拣错可及时撤销',
          ],
        },
        {
          title: '包装发货',
          description: '拣货完成后进行包装，填写物流信息（快递公司、运单号）。',
          tips: [
            '支持多种物流公司',
            '运单号可自动推送给客户',
            '可打印装箱单和发货清单',
          ],
        },
        {
          title: '确认出库',
          description: '包装完成后确认出库，系统扣减库存，生成出库凭证。',
          tips: [
            '出库后库存实时更新',
            '财务自动生成销售出库单',
            '可追踪物流状态',
          ],
        },
      ],
      faqs: [
        {
          question: '成品出库后客户拒收怎么办？',
          answer: '↩️ 退货需快速处理避免影响库存周转。\n\n退货入库流程：\n1. 收到客户拒收通知，确认拒收原因\n2. 进入【成品出库】→【退货管理】\n3. 点击【创建退货单】，关联原出库单\n4. 填写退货信息：\n   • 退货数量（可部分退货）\n   • 退货原因（质量问题/尺码错误/数量错误）\n   • 物流运单号\n5. 货物到达后扫码验收入库\n6. 系统自动恢复库存（可用数量+退货数量）\n7. 根据原因判断是否需要质检复核\n\n重新发货：\n1. 退货入库完成后，检查库存充足\n2. 创建新出库单，关联原订单\n3. 备注"补发"，避免重复计费\n4. 扫码拣货、包装、发货\n\n⚠️ 注意事项：\n• 质量问题退货需拍照留证\n• 退货运费由责任方承担（质量问题由我方承担）\n• 频繁退货客户需分析根本原因',
        },
        {
          question: '如何处理紧急加急订单？',
          answer: '🚨 加急订单优先处理机制。\n\n加急标记步骤：\n1. 创建出库单时勾选【加急订单】选项\n2. 选择加急等级：\n   • 🔴 特急（2小时内发货）\n   • 🟠 加急（当天发货）\n   • 🟡 优先（次日发货）\n3. 填写加急原因和客户要求\n4. 保存后系统自动：\n   • 出库单列表置顶显示（红色标记）\n   • 推送通知给仓管主管和拣货人员\n   • 短信/微信提醒相关人员\n\n加急处理流程：\n1. 仓管收到通知后立即响应\n2. 优先拣货、优先打包\n3. 联系快递上门取件（协商加急服务）\n4. 实时更新物流状态\n5. 发货后通知客户运单号\n\n⚠️ 管理建议：\n• 加急订单需额外收费（快递费+加急费）\n• 控制加急比例（< 10%），避免影响正常订单\n• 分析加急原因，优化交期管理减少加急',
        },
      ],
    },
    {
      id: 'reconciliation',
      title: '工厂对账与结算',
      category: 'finance',
      difficulty: 'advanced',
      duration: '10分钟',
      tags: ['对账', '财务', '结算', '工厂'],
      steps: [
        {
          title: '工厂对账',
          description: '从「财务管理」→「工厂对账」进入，选择对账周期和工厂，系统自动汇总该期间的订单和工序数据。',
          tips: [
            '建议每月对账一次',
            '对账前确保所有扫码记录已提交',
            '可导出明细Excel核对',
          ],
        },
        {
          title: '核对明细',
          description: '核对工序数量、单价、总金额，处理异常数据（如重复扫码、工序错误）。',
          tips: [
            '异常数据可标记需复核',
            '支持手动调整金额（需备注原因）',
            '重大差异需工厂确认签字',
          ],
        },
        {
          title: '生成对账单',
          description: '确认无误后生成对账单，包含订单汇总、工序明细、应付金额等。',
          tips: [
            '对账单需要双方签字盖章',
            '系统自动生成PDF文件',
            '可发送邮件给工厂',
          ],
        },
        {
          title: '审批与付款',
          description: '对账单提交审批流程，财务审核后安排付款。',
          tips: [
            '审批流程可自定义（如主管→财务→总经理）',
            '付款后系统自动标记已结清',
            '支持部分付款（如预付30%）',
          ],
        },
      ],
      faqs: [
        {
          question: '对账金额与工厂报价不一致怎么办？',
          answer: '💰 金额差异需逐项排查。\n\n差异排查步骤：\n1. 导出对账明细Excel（系统自动计算）\n2. 导出工厂提供的报价明细\n3. 逐项对比：\n   ✓ 订单数量是否一致\n   ✓ 工序名称是否匹配\n   ✓ 单价是否正确（检查系统配置）\n   ✓ 扫码记录是否有重复或遗漏\n\n常见差异原因：\n• 单价配置错误：在【工序管理】核对单价\n• 重复扫码：在【扫码记录】查找重复数据并删除\n• 遗漏扫码：补录缺失的工序记录\n• 工序名称不一致：统一工序字典\n\n协商调整流程：\n1. 双方确认差异明细\n2. 判定责任（系统错误/人为失误/合同变更）\n3. 在系统【手动调整】功能修改金额\n4. 必须填写调整原因和审批人\n5. 双方签字确认调整单\n6. 备案调整记录便于审计\n\n⚠️ 预防措施：\n• 合同签订时明确单价和结算规则\n• 每月对账，避免累积大额差异\n• 定期核对单价配置是否与合同一致',
        },
        {
          question: '物料对账与工厂对账有什么区别？',
          answer: '📋 两种对账核算不同费用类型。\n\n物料对账（采购结算）：\n• 对象：供应商（面料商、辅料商）\n• 依据：采购单\n• 内容：物料名称、规格、数量、单价、金额\n• 周期：按批次或按月\n• 公式：应付款 = Σ(采购数量 × 单价)\n• 示例：\n  - 面料A：1000米 × 30元/米 = 30,000元\n  - 辅料B：5000个 × 0.5元/个 = 2,500元\n  - 总计：32,500元\n\n工厂对账（加工结算）：\n• 对象：加工工厂或车间\n• 依据：扫码记录（工序完成数量）\n• 内容：订单、工序、数量、单价、金额\n• 周期：按月\n• 公式：应付款 = Σ(工序数量 × 工序单价)\n• 示例：\n  - 做领：500件 × 2元/件 = 1,000元\n  - 上领：500件 × 1.5元/件 = 750元\n  - 总计：1,750元\n\n区别对比：\n┌─────────┬──────────┬──────────┐\n│ 项目     │ 物料对账   │ 工厂对账   │\n├─────────┼──────────┼──────────┤\n│ 核算对象 │ 材料成本   │ 人工成本   │\n│ 数据来源 │ 采购单入库 │ 扫码记录   │\n│ 结算单位 │ 米/个/公斤 │ 件/套      │\n│ 对账频率 │ 灵活       │ 固定月结   │\n└─────────┴──────────┴──────────┘\n\n⚠️ 注意事项：\n• 两种对账独立进行，不能混淆\n• 最终汇总到【财务报表】统一核算成本\n• 物料对账关注价格波动，工厂对账关注效率',
        },
      ],
    },
    {
      id: 'sample-management',
      title: '样衣开发与管理',
      category: 'sample',
      difficulty: 'beginner',
      duration: '8分钟',
      tags: ['样衣', '款式', '开发'],
      steps: [
        {
          title: '创建新款式',
          description: '从「样衣管理」→「样衣开发」进入，点击「新建款式」，填写款号、款名、类别等基本信息。',
          tips: [
            '款号格式建议统一（如HYY20222）',
            '款名要简洁明了，便于识别',
            '类别需要在字典管理中预先配置',
          ],
        },
        {
          title: '上传款式图片和资料',
          description: '上传款式封面图、细节图、放码纸样文件（.dxf/.plt/.ets格式）。',
          tips: [
            '封面图建议正面图，尺寸800×800px',
            '放码纸样是后续生产订单的必需文件',
            '支持批量上传多张细节图',
          ],
        },
        {
          title: '配置BOM物料清单',
          description: '添加该款式所需的面料、辅料、配件，设置每件用量和单价。',
          tips: [
            '物料需要在「面辅料数据库」中预先创建',
            '用量单位要准确（米、个、公斤）',
            '单价会自动汇总计算成本',
          ],
        },
        {
          title: '设置工序流程',
          description: '配置该款式的生产工序顺序和每道工序的工价。',
          tips: [
            '工序顺序影响小程序扫码识别',
            '工价用于后续工厂对账',
            '常见工序：裁剪→缝制→整烫→质检→包装',
          ],
        },
      ],
      faqs: [
        {
          question: '款式创建后可以修改吗？',
          answer: '✅ 可以修改，但需注意：\n\n• 基本信息（款号、名称）随时可改\n• BOM物料变更会影响已创建的采购单\n• 工序流程变更会影响进行中的订单\n• 建议重大变更时创建新版本款号',
        },
        {
          question: '放码纸样文件支持哪些格式？',
          answer: '📄 支持主流CAD格式：\n\n• .dxf（AutoCAD）\n• .plt（绘图仪）\n• .ets（力克系统）\n• .pat（格柏系统）\n\n文件要求：\n• 尺寸准确无误\n• 包含所有尺码的放码信息\n• 单个文件 < 50MB',
        },
      ],
    },
    {
      id: 'pattern-production',
      title: '样板生产流程',
      category: 'sample',
      difficulty: 'intermediate',
      duration: '6分钟',
      tags: ['样板', '生产', '打样'],
      steps: [
        {
          title: '创建样板生产任务',
          description: '从「样衣管理」→「样板生产」进入，选择款式创建样板任务。',
          tips: [
            '可同时创建多个款式的样板任务',
            '设置优先级和交期',
          ],
        },
        {
          title: '分配打样工厂',
          description: '选择承接打样的工厂或车间，系统会自动通知工厂。',
          tips: [
            '可查看工厂当前任务负载',
            '支持多工厂并行打样',
          ],
        },
        {
          title: '跟踪打样进度',
          description: '实时查看打样阶段（裁剪→缝制→整烫→成品），工厂完成后自动流转。',
          tips: [
            '支持小程序扫码更新进度',
            '可设置关键节点提醒',
          ],
        },
        {
          title: '样板验收',
          description: '样板完成后进行验收，拍照记录，确认合格后归档。',
          tips: [
            '不合格需填写返修意见',
            '合格样板可转为标准款式',
          ],
        },
      ],
      faqs: [
        {
          question: '样板生产和正式订单有什么区别？',
          answer: '🎯 主要区别：\n\n样板生产：\n• 数量少（通常1-3件）\n• 重点验证款式和工艺\n• 周期短（3-5天）\n• 不计入库存\n\n正式订单：\n• 数量大（批量生产）\n• 标准化流程\n• 周期长（15-30天）\n• 计入库存和财务',
        },
      ],
    },
    {
      id: 'data-center',
      title: '资料中心使用指南',
      category: 'sample',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['资料', '查询', '归档'],
      steps: [
        {
          title: '查询款式资料',
          description: '通过款号、款名、分类等条件快速检索历史款式。',
          tips: [
            '支持模糊搜索',
            '可按时间范围筛选',
            '支持批量导出',
          ],
        },
        {
          title: '查看款式详情',
          description: '点击款式查看完整信息：图片、BOM、工序、历史订单等。',
          tips: [
            '所有附件可一键下载',
            '可查看款式销售数据',
          ],
        },
        {
          title: '款式复用',
          description: '将历史款式复制为新款式，快速创建相似款。',
          tips: [
            '修改款号避免重复',
            '根据需要调整BOM和工序',
          ],
        },
      ],
      faqs: [
        {
          question: '如何快速找到去年的某个款式？',
          answer: '🔍 使用高级搜索：\n\n1. 点击【高级筛选】\n2. 设置时间范围（2025-01-01 ~ 2025-12-31）\n3. 输入款号关键词或分类\n4. 点击【查询】',
        },
      ],
    },
    {
      id: 'template-price',
      title: '单价维护与成本核算',
      category: 'sample',
      difficulty: 'intermediate',
      duration: '7分钟',
      tags: ['单价', '成本', '报价'],
      steps: [
        {
          title: '维护物料单价',
          description: '从「样衣管理」→「单价维护」进入，更新面料、辅料的采购单价。',
          tips: [
            '定期更新单价（建议每月）',
            '保留历史单价记录',
            '支持批量导入Excel',
          ],
        },
        {
          title: '维护工序单价',
          description: '设置各工序的人工单价，按件计算。',
          tips: [
            '不同工厂单价可能不同',
            '复杂工序单价更高',
            '定期与工厂协商调整',
          ],
        },
        {
          title: '自动成本核算',
          description: '系统根据BOM用量和单价自动计算款式成本。',
          tips: [
            '成本 = 物料成本 + 人工成本',
            '用于报价参考',
            '可添加利润率自动生成报价',
          ],
        },
      ],
      faqs: [
        {
          question: '单价更新后，已创建的订单会受影响吗？',
          answer: '❌ 不会影响已创建订单。\n\n原因：\n• 订单创建时会快照当时的单价\n• 后续单价变更不影响历史数据\n• 确保财务对账准确\n\n如需调整历史订单价格：\n• 需要手动在订单中调整\n• 需要审批流程确认',
        },
      ],
    },
    {
      id: 'material-database',
      title: '面辅料数据库管理',
      category: 'warehouse',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['面辅料', '物料', '数据库'],
      steps: [
        {
          title: '添加新物料',
          description: '从「仓库管理」→「面辅料数据库」点击「新增物料」，填写物料基本信息。',
          tips: [
            '物料编号建议统一格式（如F001-面料，F002-辅料）',
            '详细填写规格参数便于后续查找',
            '可上传物料实拍图',
          ],
        },
        {
          title: '设置物料属性',
          description: '填写成分、颜色、克重、门幅等物料特性。',
          tips: [
            '成分如：棉100%、涤纶65%棉35%',
            '门幅常见：140cm、150cm',
            '克重影响用料计算',
          ],
        },
        {
          title: '关联供应商',
          description: '绑定该物料的常用供应商和采购价格。',
          tips: [
            '可设置多个供应商比价',
            '标记首选供应商',
            '记录供应商起订量',
          ],
        },
      ],
      faqs: [
        {
          question: '同一种面料不同颜色需要分开创建吗？',
          answer: '✅ 建议分开创建。\n\n原因：\n• 不同颜色价格可能不同\n• 库存分开管理更清晰\n• 便于BOM精确配置\n\n命名建议：\n• F001-全棉府绸-白色\n• F001-全棉府绸-黑色',
        },
      ],
    },
    {
      id: 'order-management',
      title: '下单管理流程',
      category: 'sample',
      difficulty: 'beginner',
      duration: '6分钟',
      tags: ['下单', '订单', '跟单'],
      steps: [
        {
          title: '接收客户订单',
          description: '从「样衣管理」→「下单管理」创建客户订单，填写客户信息和订单明细。',
          tips: [
            '记录客户联系方式',
            '明确交货日期和地点',
            '特殊要求需备注清楚',
          ],
        },
        {
          title: '转化为生产订单',
          description: '审核通过后，一键转化为生产订单，自动流转到生产部门。',
          tips: [
            '转化时会自动关联款式BOM',
            '生成采购需求单',
            '创建生产排期',
          ],
        },
        {
          title: '跟踪订单状态',
          description: '实时查看订单进度（采购→裁剪→生产→质检→入库→发货）。',
          tips: [
            '关键节点自动提醒',
            '延期订单红色警示',
            '可导出订单跟踪表',
          ],
        },
      ],
      faqs: [
        {
          question: '客户订单和生产订单有什么区别？',
          answer: '📝 两种订单用途不同：\n\n客户订单：\n• 面向销售管理\n• 记录客户信息和商务条款\n• 可包含多个款式\n\n生产订单：\n• 面向生产执行\n• 单一款式\n• 指导车间生产',
        },
      ],
    },
    {
      id: 'dashboard',
      title: '仪表盘数据分析',
      category: 'system',
      difficulty: 'beginner',
      duration: '4分钟',
      tags: ['仪表盘', '数据', '分析'],
      steps: [
        {
          title: '查看核心指标',
          description: '登录后默认进入仪表盘，实时查看订单数、生产进度、库存预警等核心数据。',
          tips: [
            '数据每小时自动更新',
            '红色数字表示预警',
            '点击数字可查看明细',
          ],
        },
        {
          title: '自定义筛选条件',
          description: '选择工厂、时间范围等筛选条件，查看特定维度的数据。',
          tips: [
            '支持按月、按季度统计',
            '可对比历史同期数据',
            '导出统计报表',
          ],
        },
        {
          title: '图表分析',
          description: '通过柱状图、饼图、趋势图直观分析业务数据。',
          tips: [
            '鼠标悬停查看详细数值',
            '点击图例筛选数据',
            '图表可导出为图片',
          ],
        },
      ],
      faqs: [
        {
          question: '仪表盘数据多久更新一次？',
          answer: '⏰ 更新频率：\n\n• 订单数据：实时更新\n• 生产进度：扫码后立即更新\n• 库存数据：出入库后实时更新\n• 统计报表：每小时整点更新\n\n手动刷新：点击右上角【刷新】按钮',
        },
      ],
    },
    {
      id: 'payroll-settlement',
      title: '工资结算完整流程',
      category: 'finance',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['工资', '结算', '财务'],
      steps: [
        {
          title: '了解工资结算全流程',
          description: '工资结算涉及多个页面协同操作，整体流程为：扫码记录（小程序/PC） → 工资查询汇总（核对明细） → 结算生成工资单 → 付款中心（发放工资）。',
          tips: [
            '扫码记录：工人通过小程序或PC端完成扫码，产生计件数据',
            '工资查询汇总：【财务管理→工资结算(内)】，查看和核对扫码明细',
            '付款中心：【财务管理→付款中心】，完成工资发放',
            '详细操作请查看：「工资查询汇总」和「付款中心」教程',
          ],
        },
        {
          title: '第1步：核对扫码记录',
          description: '进入「财务管理」→「工资结算(内)」，在「扫码明细」Tab中查看当月的扫码记录，确认数量和金额正确。',
          tips: [
            '建议每月1-5号核对上月工资',
            '重点检查：工序数量、单价、工人归属',
            '异常记录及时联系工人核实',
          ],
        },
        {
          title: '第2步：查看人员汇总',
          description: '切换到「人员汇总」Tab，按人员维度查看每个工人的工资总额。公式：工资 = Σ(工序数量 × 工序单价)。',
          tips: [
            '点击某人可展开查看其工序明细',
            '对比上月数据，检查是否有异常波动',
            '异常数据会标红提示',
          ],
        },
        {
          title: '第3步：发起工资付款',
          description: '核对无误后，进入「财务管理」→「付款中心」，在待付款列表中找到工资项目，选择支付方式完成付款。',
          tips: [
            '支持线下付款、银行转账、微信、支付宝',
            '付款后上传转账凭证',
            '已付款记录可在「支付记录」Tab中查看',
          ],
        },
      ],
      faqs: [
        {
          question: '工人对工资有异议怎么办？',
          answer: '🔍 异议处理流程：\n\n1. 进入【财务管理】→【工资结算(内)】\n2. 在「扫码明细」中输入工人姓名查询\n3. 逐条核对工序数量和单价\n4. 如发现错误：\n   • 扫码记录错误：未结算的可撤回重录\n   • 单价配置错误：调整工序单价后重新计算\n   • 其他原因：手动调整并备注\n5. ⚠️ 已结算的记录不允许撤回\n6. 如确需修改已结算数据，联系管理员处理',
        },
      ],
    },
    {
      id: 'warehouse-dashboard',
      title: '仓库数据看板',
      category: 'warehouse',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['仓库', '看板', '数据'],
      steps: [
        {
          title: '查看库存总览',
          description: '从「仓库管理」→「数据看板」查看物料和成品的总库存、周转率等数据。',
          tips: [
            '红色表示低于安全库存',
            '黄色表示接近安全库存',
            '绿色表示库存充足',
          ],
        },
        {
          title: '出入库趋势分析',
          description: '查看近期出入库趋势图，分析库存周转情况。',
          tips: [
            '可切换日、周、月维度',
            '异常波动需要分析原因',
          ],
        },
        {
          title: '库存预警',
          description: '实时显示缺货预警、超库存预警、临期物料预警。',
          tips: [
            '设置预警阈值',
            '自动推送提醒',
            '一键生成采购建议',
          ],
        },
      ],
      faqs: [
        {
          question: '如何设置库存安全线？',
          answer: '⚙️ 安全库存设置：\n\n1. 进入【仓库管理】→【库存设置】\n2. 选择物料或成品\n3. 设置：\n   • 安全库存：最低保有量\n   • 最高库存：超出需要预警\n   • 补货提前期：提前多少天提醒采购\n4. 保存后自动生效\n\n计算建议：\n安全库存 = 平均日用量 × 采购周期 × 1.5（安全系数）',
        },
      ],
    },
    {
      id: 'sample-inventory',
      title: '样衣出入库管理',
      category: 'warehouse',
      difficulty: 'beginner',
      duration: '4分钟',
      tags: ['样衣', '库存', '借还'],
      steps: [
        {
          title: '样衣入库',
          description: '样板生产完成后，进行样衣入库登记，分配库位。',
          tips: [
            '扫描款式二维码快速入库',
            '拍照记录样衣状态',
            '设置是否可外借',
          ],
        },
        {
          title: '样衣借出',
          description: '业务员或客户借用样衣时，填写借出单。',
          tips: [
            '记录借出人和归还日期',
            '超期自动提醒',
            '可设置押金',
          ],
        },
        {
          title: '样衣归还',
          description: '样衣归还后，核对状态并办理归还手续。',
          tips: [
            '检查样衣是否完好',
            '损坏需要照相记录',
            '更新库存状态',
          ],
        },
      ],
      faqs: [
        {
          question: '样衣丢失或损坏如何处理？',
          answer: '💔 损失处理流程：\n\n1. 拍照记录损坏情况\n2. 填写【样衣损失单】\n3. 判定责任：\n   • 借用人责任：按成本赔偿\n   • 正常损耗：报废处理\n4. 主管审批\n5. 从库存中核销\n6. 财务记录损失',
        },
      ],
    },
    {
      id: 'dict-management',
      title: '字典管理使用指南',
      category: 'system',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['字典', '配置', '基础数据'],
      steps: [
        {
          title: '了解字典类型',
          description: '字典用于统一下拉选项，如颜色、尺码、工序名称等。',
          tips: [
            '字典类型由系统预定义',
            '字典值可以自定义添加',
            '修改后全系统生效',
          ],
        },
        {
          title: '添加字典值',
          description: '从「系统设置」→「字典管理」选择字典类型，点击「新增」添加选项。',
          tips: [
            '标签：显示给用户的文字（如"红色"）',
            '值：系统内部使用的代码（如"red"）',
            '排序号：控制显示顺序',
          ],
        },
        {
          title: '启用/禁用字典',
          description: '可以禁用不再使用的字典值，避免误选。',
          tips: [
            '禁用后不会删除历史数据',
            '新创建记录中不显示',
            '可随时重新启用',
          ],
        },
      ],
      faqs: [
        {
          question: '常见字典类型有哪些？',
          answer: '📚 系统预置字典：\n\n• 颜色：红、黑、白、蓝...\n• 尺码：S、M、L、XL、XXL\n• 工序：裁剪、缝制、整烫、质检...\n• 物料类别：面料、辅料、配件\n• 客户等级：VIP、普通、临时',
        },
      ],
    },
    {
      id: 'user-permission',
      title: '人员与权限管理',
      category: 'system',
      difficulty: 'intermediate',
      duration: '7分钟',
      tags: ['权限', '人员', '角色'],
      steps: [
        {
          title: '创建用户账号',
          description: '从「系统设置」→「人员管理」点击「新增用户」，填写用户信息（姓名、账号、密码、手机号等）。',
          tips: [
            '账号格式建议：工号或手机号',
            '初始密码建议设置为统一格式（如123456），提醒用户首次登录修改',
            '手机号用于接收通知和找回密码',
          ],
        },
        {
          title: '分配角色',
          description: '为用户分配角色（如管理员、工厂操作员、财务人员等），角色决定了用户的菜单和操作权限。',
          tips: [
            '一个用户可以有多个角色',
            '角色继承权限（如"财务经理"包含"财务人员"的所有权限）',
            '新建角色需要先在「角色管理」中配置',
          ],
        },
        {
          title: '配置数据权限',
          description: '设置用户的数据范围（全部数据 / 仅本工厂数据），多工厂场景下实现数据隔离。',
          tips: [
            'dataScope=ALL：查看所有工厂数据（适合管理员）',
            'dataScope=FACTORY_ONLY：仅查看本工厂数据（适合工厂操作员）',
            '数据权限与菜单权限独立配置',
          ],
        },
        {
          title: '测试账号权限',
          description: '创建后建议先用测试环境或小号登录验证权限配置是否正确。',
          tips: ['检查菜单是否正确显示', '测试关键操作是否可执行', '验证数据范围是否准确'],
        },
      ],
      faqs: [
        {
          question: '如何禁用某个用户？',
          answer: '🚫 禁用用户保留数据但阻止登录。\n\n禁用操作：\n1. 进入【系统设置】→【人员管理】\n2. 在用户列表搜索目标用户（姓名/账号）\n3. 点击该用户右侧【更多】→【禁用】\n4. 系统弹窗确认："确定禁用该用户？"\n5. 点击【确定】，用户状态变为"已禁用"（红色标记）\n\n禁用后效果：\n• ❌ 用户无法登录PC端和小程序\n• ✅ 历史数据完整保留（订单、扫码记录、对账单）\n• ✅ 数据统计中仍包含该用户的贡献\n• ❌ 无法分配新任务或接收通知\n\n启用恢复：\n1. 找到已禁用用户（筛选"已禁用"状态）\n2. 点击【更多】→【启用】\n3. 用户恢复正常，可重新登录\n\n⚠️ 适用场景：\n• 员工离职（保留数据便于审计）\n• 临时暂停权限（如违规操作）\n• 长期休假（避免账号被盗用）\n\n💡 与删除的区别：\n• 禁用：可恢复，数据保留\n• 删除：不可恢复，数据清空（谨慎使用！）',
        },
        {
          question: '角色权限修改后，已登录用户会立即生效吗？',
          answer: '⏰ 不会立即生效，需重新登录。\n\n权限生效机制：\n1. 用户登录时，系统颁发Token（有效期2小时）\n2. Token包含用户权限信息（菜单、操作、数据范围）\n3. 前端根据Token判断显示哪些菜单和按钮\n4. 修改角色权限后，旧Token仍然有效\n5. 直到Token过期或用户重新登录，才获取新权限\n\n立即生效方法：\n\n方法1 - 通知用户重新登录：\n1. 修改权限后，通知相关用户\n2. 用户点击右上角【退出登录】\n3. 重新登录，获取最新权限\n\n方法2 - 管理员强制踢出（紧急）：\n1. 进入【系统设置】→【登录日志】\n2. 找到在线用户（状态="在线"）\n3. 点击【强制下线】\n4. 用户被踢出，下次登录获取新权限\n\n方法3 - 等待自动过期（2小时）：\n• 不需要操作\n• Token到期后自动失效\n• 用户刷新页面或操作时会自动重新登录\n\n⚠️ 注意事项：\n• 重大权限变更建议提前通知\n• 强制下线会中断用户当前操作\n• 权限配置前先在测试账号验证',
        },
      ],
    },
    // ==================== 以下为补齐的系统功能教程 ====================
    {
      id: 'login-register',
      title: '登录注册与首次使用',
      category: 'getting-started',
      difficulty: 'beginner',
      duration: '3分钟',
      tags: ['登录', '注册', '入门必看'],
      steps: [
        {
          title: '打开系统登录页',
          description: '在浏览器地址栏输入系统地址（如 http://localhost:5173），进入登录页面。',
          tips: [
            '推荐使用 Chrome / Edge 浏览器，兼容性最佳',
            '内网访问地址：http://192.168.2.248:5173',
            '首次访问加载较慢属正常现象（约3-5秒）',
          ],
        },
        {
          title: '输入账号密码登录',
          description: '输入管理员分配的账号和密码，点击「登录」按钮进入系统。',
          tips: [
            '默认初始密码为 123456，首次登录后建议立即修改',
            '连续输错5次会锁定账号15分钟',
            '忘记密码请联系系统管理员重置',
          ],
        },
        {
          title: '注册新账号（管理员操作）',
          description: '如需注册新账号，点击登录页的「注册」链接，填写姓名、手机号、密码等信息提交注册申请。',
          tips: [
            '注册后需要管理员审批才能使用',
            '手机号不可重复，每个手机号只能注册一个账号',
            '注册成功后默认无任何权限，需要管理员分配角色',
          ],
        },
        {
          title: '首次登录引导',
          description: '首次登录后系统会显示引导页面，建议按以下顺序熟悉系统：仪表盘 → 样衣管理 → 生产管理 → 财务管理。',
          tips: [
            '左侧菜单栏显示的功能取决于你的角色权限',
            '点击右上角头像可修改个人信息和密码',
            '遇到问题可进入「系统教学」查看操作指南',
          ],
        },
      ],
      faqs: [
        {
          question: '登录时提示"账号不存在"怎么办？',
          answer: '🔑 可能原因与解决方案：\n\n原因1 - 账号未创建：\n• 联系管理员在【系统设置】→【人员管理】中创建账号\n• 确认使用的是系统账号（非手机号登录）\n\n原因2 - 账号被禁用：\n• 联系管理员检查账号状态\n• 管理员在【人员管理】中重新启用\n\n原因3 - 输入错误：\n• 检查大小写（账号区分大小写）\n• 检查是否有多余空格\n• 尝试复制粘贴账号避免输入错误',
        },
        {
          question: '登录后看不到任何菜单怎么办？',
          answer: '⚠️ 菜单显示取决于权限配置。\n\n解决步骤：\n1. 联系管理员确认你的账号已分配角色\n2. 管理员进入【系统设置】→【人员管理】\n3. 找到你的账号，点击【编辑】→【分配角色】\n4. 选择合适的角色（如"生产人员"、"财务人员"）\n5. 保存后你需要【退出登录】→【重新登录】\n6. 刷新页面后菜单即可显示\n\n💡 常见角色说明：\n• 管理员：所有功能\n• 生产人员：订单+裁剪+扫码+进度\n• 财务人员：对账+工资+结算\n• 仓管人员：库存+出入库',
        },
      ],
    },
    {
      id: 'progress-detail',
      title: '生产进度追踪',
      category: 'production',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['生产进度', '工序追踪', '订单管理'],
      steps: [
        {
          title: '进入生产进度页面',
          description: '从左侧菜单选择「生产管理」→「生产进度」，进入生产进度追踪页面。页面顶部显示三组统计卡片：总订单/总数量、延期订单/延期数量、今日订单/今日数量。',
          tips: [
            '红色数字表示延期订单，需优先关注',
            '支持列表视图和卡片视图两种显示模式（右上角切换）',
            '卡片视图适合快速浏览，列表视图适合详细筛选',
          ],
        },
        {
          title: '筛选和搜索订单',
          description: '使用页面顶部的搜索栏，可按订单号、款号、工厂名称等条件快速定位订单。支持状态筛选（待生产/生产中/已完成/已延期）和日期范围筛选。',
          tips: [
            '搜索框支持模糊匹配，输入部分订单号即可',
            '可同时组合多个筛选条件精确查找',
            '筛选条件会自动保存，下次进入页面自动恢复',
          ],
        },
        {
          title: '查看工序进度节点',
          description: '每个订单显示5个核心工序节点：采购 → 裁剪 → 车缝 → 尾部 → 入库。每个节点显示完成数量和完成百分比，颜色表示状态（灰色=未开始，蓝色=进行中，绿色=已完成）。',
          tips: [
            '点击某个工序节点可查看该节点的详细数据（菲号明细、扫码记录）',
            '百分比 = 该工序完成数量 ÷ 订单总数量 × 100%',
            '鼠标悬停在节点上可快速查看完成数/总数',
          ],
        },
        {
          title: 'PC端扫码确认（管理员操作）',
          description: '点击订单右侧的「扫码」按钮，打开PC端扫码弹窗。选择菲号和工序，输入完成数量后提交。此功能用于管理员在PC端补录或确认工厂扫码记录。',
          tips: [
            '日常生产主要通过小程序扫码，PC端扫码用于补录和修正',
            '扫码前确认工序和数量正确，提交后会立即计入进度',
            '支持批量选择多个菲号同时提交',
          ],
        },
        {
          title: '快速编辑与订单操作',
          description: '点击订单右侧「更多」菜单，可进行：快速编辑（修改交期、备注）、打印款式标签、查看操作日志、关闭订单等操作。',
          tips: [
            '关闭订单会终止所有工序统计，请谨慎操作',
            '款式标签可批量打印，贴在裁片上用于识别',
            '操作日志记录该订单的所有变更历史',
          ],
        },
      ],
      faqs: [
        {
          question: '订单显示"延期"但实际已完成怎么办？',
          answer: '⏰ 延期标记基于交货日期自动判断。\n\n解决步骤：\n1. 点击订单进入详情\n2. 点击【快速编辑】\n3. 修改交货日期为实际完成日期\n4. 保存后延期标记自动消除\n\n⚠️ 也可能是最后工序（入库）未完成：\n1. 检查"入库"节点是否100%\n2. 如有遗漏，补录入库记录\n3. 全部工序100%后订单自动标为"已完成"',
        },
        {
          question: '如何查看某个工人在某订单的扫码记录？',
          answer: '🔍 两种查询方式：\n\n方式1 - 从生产进度页面查看：\n1. 找到目标订单\n2. 点击某个工序节点（如"车缝"）\n3. 弹窗中显示该工序的所有扫码记录\n4. 可按工人姓名筛选\n\n方式2 - 从工资查询汇总查看：\n1. 进入【财务管理】→【工资结算(内)】\n2. 输入订单号 + 员工姓名\n3. 查看该员工在该订单的所有扫码明细\n4. 包含工序名称、数量、金额、时间',
        },
        {
          question: '列表视图和卡片视图有什么区别？',
          answer: '📋 两种视图适用不同场景：\n\n列表视图（默认）：\n• 表格形式，每行一个订单\n• 适合批量管理和数据导出\n• 支持排序和高级筛选\n• 信息密度高，适合大屏幕\n\n卡片视图：\n• 每个订单一张卡片，包含进度条\n• 适合快速浏览和直观判断\n• 工序节点可视化更清晰\n• 适合触屏操作和小屏幕\n\n切换方法：点击页面右上角的视图切换图标',
        },
      ],
    },
    {
      id: 'material-purchase',
      title: '面辅料采购管理',
      category: 'production',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['采购', '物料', '领取'],
      steps: [
        {
          title: '进入物料采购页面',
          description: '从左侧菜单选择「生产管理」→「物料采购」进入。页面顶部显示统计卡片：总采购数/总数量、待领取、已领取、部分领取、已完成、已取消。',
          tips: [
            '页面有两个Tab：「采购单」管理和「物料数据库」',
            '统计卡片可快速了解当前采购状态分布',
            '筛选条件会自动缓存，下次进入页面自动恢复',
          ],
        },
        {
          title: '创建采购单',
          description: '在「采购单」Tab下，点击「+ 新建采购单」按钮，选择关联的生产订单，系统自动根据BOM清单计算所需物料数量。手动填写供应商、预计到货日期等信息后保存。',
          tips: [
            '关联订单后，系统自动计算BOM用量（面料米数、辅料数量等）',
            '可手动调整采购数量（如多采购10%作为损耗余量）',
            '一个订单可以创建多个采购单（分批采购）',
          ],
        },
        {
          title: '预览和打印采购单',
          description: '创建成功后，点击采购单右侧的「预览」按钮，查看采购单的打印格式。确认无误后可直接打印或导出PDF发给供应商。',
          tips: [
            '打印格式包含：物料明细、数量、规格、供应商信息',
            '导出PDF可通过微信/邮件发送给供应商',
            '建议打印两份：一份给供应商，一份留档',
          ],
        },
        {
          title: '智能领取确认',
          description: '供应商送货后，点击「智能领取」按钮。系统根据订单号自动匹配所有待领取的物料，核对数量后确认领取，物料自动入库。',
          tips: [
            '智能领取会自动匹配同一订单的所有待领取物料',
            '实际到货数量与采购数量不同时，可手动调整',
            '部分到货选择「部分领取」，剩余继续等待',
            '领取确认后物料自动入库，库存实时更新',
          ],
        },
        {
          title: '退回处理',
          description: '如果物料有质量问题或规格不符，可以进行退回操作。点击「退回确认」，填写退回原因和数量，系统自动扣减已领取库存。',
          tips: [
            '退回需要详细填写原因（如质量问题、规格不符）',
            '退回后采购单状态自动回退到"待领取"',
            '「退回重置」可一键将退回的采购单恢复初始状态',
          ],
        },
      ],
      faqs: [
        {
          question: '采购单和入库单有什么区别？',
          answer: '📦 两个单据用途不同：\n\n采购单（物料采购页面）：\n• 面向供应商的订购凭证\n• 记录"要买什么、买多少、找谁买"\n• 创建后发给供应商\n• 状态：待领取 → 已领取 → 已完成\n\n入库单（面辅料进销存页面）：\n• 面向仓库的入库凭证\n• 记录"实际收到什么、放在哪个库位"\n• 领取确认后自动生成\n• 包含库位分配和批次信息\n\n关系：采购单 → 领取确认 → 自动生成入库记录',
        },
        {
          question: '如何处理供应商多发或少发的情况？',
          answer: '📊 分两种情况处理：\n\n少发处理：\n1. 智能领取时输入实际到货数量\n2. 选择「部分领取」\n3. 差额部分保持"待领取"状态\n4. 供应商补发后再次领取\n\n多发处理：\n1. 领取时实际数量 > 采购数量\n2. 确认是否需要全部接收\n3. 需要：调整采购数量后领取\n4. 不需要：只领取采购数量，多余退回供应商',
        },
      ],
    },
    {
      id: 'material-inventory',
      title: '面辅料进销存管理',
      category: 'warehouse',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['面辅料', '库存', '进销存', '入库', '出库'],
      steps: [
        {
          title: '进入面辅料进销存页面',
          description: '从左侧菜单选择「仓库管理」→「面辅料进销存」进入。页面顶部显示四个统计卡片：库存总值、总数量、低库存预警数、物料种类数。',
          tips: [
            '此页面管理面辅料的所有进出库操作',
            '红色预警数字表示有物料低于安全库存，需及时采购',
            '可按物料类型（面料/辅料/包材等）筛选查看',
          ],
        },
        {
          title: '入库操作',
          description: '点击「入库」按钮，选择入库物料，填写入库数量、供应商、批次号、仓库位置等信息。支持扫码入库和手工录入两种方式。',
          tips: [
            '入库时必须选择供应商和仓库位置',
            '批次号建议格式：日期+序号（如20260222-01）',
            '面料类物料可填写门幅、克重、成分等详细参数',
            '入库成功后库存实时更新',
          ],
        },
        {
          title: '出库操作',
          description: '点击「出库」按钮，选择出库物料和数量，关联生产订单（领料出库）。系统自动验证库存充足后完成出库。',
          tips: [
            '出库数量不能超过可用库存',
            '关联订单后可追溯物料用于哪个订单',
            '出库后可用库存自动扣减',
          ],
        },
        {
          title: '安全库存设置与预警',
          description: '点击物料行的「安全库存」列，可直接编辑安全库存值。低于此值时系统自动显示红色预警。',
          tips: [
            '安全库存 = 平均日用量 × 采购周期天数 × 1.5',
            '预警物料在顶部统计卡片中汇总显示',
            '建议结合历史用量和采购周期合理设置',
          ],
        },
        {
          title: '面料卷号管理',
          description: '对于按卷管理的面料，可使用「卷号生成」功能为每卷面料生成唯一编号和二维码，便于追溯和管理。',
          tips: [
            '卷号自动生成，格式为物料编号+日期+序号',
            '生成的二维码可打印贴在面料卷上',
            '扫码即可查看该卷面料的所有信息（供应商、入库时间、剩余数量）',
          ],
        },
      ],
      faqs: [
        {
          question: '面辅料进销存和面辅料数据库有什么区别？',
          answer: '📋 两个模块职责不同：\n\n面辅料数据库（仓库管理→面辅料数据库）：\n• 管理物料的"基础信息"：编号、名称、规格、成分、供应商\n• 相当于物料档案库\n• 不涉及库存数量\n\n面辅料进销存（仓库管理→面辅料进销存）：\n• 管理物料的"库存数量"：入库、出库、库存查询\n• 实时追踪每种物料有多少\n• 包含预警和统计功能\n\n关系：先在"数据库"创建物料档案 → 再在"进销存"进行入库操作',
        },
        {
          question: '如何查看某种物料的出入库明细？',
          answer: '📊 查看历史出入库记录：\n\n操作步骤：\n1. 在面辅料进销存页面找到目标物料\n2. 点击该物料右侧「查看详情」\n3. 弹窗中显示批次明细：\n   • 每个入库批次的数量、日期、供应商\n   • 每次出库的数量、日期、关联订单\n   • 当前剩余库存\n4. 可按日期范围筛选\n\n💡 也可在搜索栏输入物料编码快速定位',
        },
      ],
    },
    {
      id: 'finished-inventory',
      title: '成品进销存管理',
      category: 'warehouse',
      difficulty: 'intermediate',
      duration: '7分钟',
      tags: ['成品', '库存', '进销存', '出库'],
      steps: [
        {
          title: '进入成品进销存页面',
          description: '从左侧菜单选择「仓库管理」→「成品进销存」进入。页面以订单+款号维度聚合显示成品库存，同一订单同一款号的不同颜色/尺码自动合并为一行。',
          tips: [
            '成品库存来源于质检入库（生产管理→质检入库），无法在此页面直接新增入库',
            '每条记录显示颜色标签和尺码标签，一目了然',
            '可按订单号、款号搜索，或按"有库存""有次品"筛选',
          ],
        },
        {
          title: '查看入库历史',
          description: '点击某条记录右侧的「入库记录」按钮，查看该订单款式的所有入库历史（每次质检入库的数量、操作人、时间）。',
          tips: [
            '入库记录按时间倒序排列，最新入库在最上方',
            '包含质检入库号、合格数量、次品数量',
            '可追溯到具体的质检入库操作',
          ],
        },
        {
          title: '成品出库（发货）',
          description: '点击「出库」按钮，弹出SKU明细出库面板。系统展开该订单的所有颜色×尺码组合，为每个SKU分别设置出库数量。确认后库存自动扣减。',
          tips: [
            '出库时按SKU（颜色+尺码）逐个设置数量，精确到件',
            '出库数量不能超过该SKU的可用库存',
            '支持部分出库（如只发部分颜色/尺码）',
            '出库后库存实时扣减，可在列表中查看最新数量',
          ],
        },
        {
          title: '次品管理',
          description: '质检入库时标记的次品数量在此页面中独立显示。可使用"有次品"筛选条件快速查看所有含次品的订单。',
          tips: [
            '次品数量不计入可用库存',
            '次品需要单独处理（返工或报废）',
            '返工完成后通过质检入库补录合格数量',
          ],
        },
      ],
      faqs: [
        {
          question: '成品入库和成品出库分别在哪里操作？',
          answer: '📦 两个操作在不同页面：\n\n成品入库：\n• 页面位置：【生产管理】→【质检入库】\n• 操作：生产完成 → 质检合格 → 录入入库数量\n• 入库后自动显示在成品进销存中\n\n成品出库：\n• 页面位置：【仓库管理】→【成品进销存】\n• 操作：在成品列表中点击【出库】按钮\n• 按SKU明细设置出库数量 → 确认\n\n⚠️ 注意：成品进销存页面只能出库，不能直接入库。入库必须通过质检入库流程。',
        },
        {
          question: '出库后如何查看发货记录？',
          answer: '📋 查看出库/发货历史：\n\n1. 进入【成品进销存】页面\n2. 找到目标订单（搜索订单号或款号）\n3. 点击右侧的【入库记录】按钮\n4. 在弹窗中可同时查看入库和出库的历史记录\n5. 每条记录包含：时间、数量、操作人\n\n💡 提示：\n• 出库记录显示每个SKU的出库明细\n• 可用库存 = 累计入库 - 累计出库',
        },
      ],
    },
    {
      id: 'material-reconciliation',
      title: '物料对账管理',
      category: 'finance',
      difficulty: 'intermediate',
      duration: '8分钟',
      tags: ['物料对账', '采购结算', '供应商'],
      steps: [
        {
          title: '进入物料对账页面',
          description: '从左侧菜单选择「财务管理」→「物料对账」进入。显示所有物料采购的对账记录列表。',
          tips: [
            '物料对账 = 与供应商核对采购金额',
            '对账数据来源于采购入库记录',
            '建议每月与供应商进行一次对账',
          ],
        },
        {
          title: '创建物料对账单',
          description: '点击「新建对账单」，选择供应商和对账周期（日期范围），系统自动汇总该供应商在此期间的所有采购入库记录，计算应付总金额。',
          tips: [
            '系统自动抓取采购记录，无需手动录入',
            '金额 = Σ(入库数量 × 采购单价)',
            '可选择按单据或按物料汇总',
          ],
        },
        {
          title: '核对对账明细',
          description: '查看对账单明细，逐项核对物料名称、数量、单价、金额。如有差异可手动调整或标记待确认。',
          tips: [
            '与供应商提供的对账单逐行比对',
            '差异项需要双方确认后调整',
            '调整记录自动保存审计日志',
          ],
        },
        {
          title: '提交审批',
          description: '对账确认后，提交审批流程。审批通过后生成应付账款，流转到「付款中心」进行付款。',
          tips: [
            '审批通过后对账单锁定，不可修改',
            '待付款会自动出现在「付款中心」',
            '支持导出对账单PDF发送供应商签字',
          ],
        },
      ],
      faqs: [
        {
          question: '物料对账和工厂对账有什么区别？',
          answer: '📋 两种对账核算不同费用类型：\n\n物料对账（财务管理→物料对账）：\n• 对象：面辅料供应商\n• 依据：采购入库记录\n• 核算：物料采购成本\n• 公式：应付 = Σ(入库数量 × 单价)\n\n工厂对账（订单结算→工厂汇总）：\n• 对象：加工工厂\n• 依据：扫码完成记录\n• 核算：加工人工成本\n• 公式：应付 = Σ(工序数量 × 工序单价)\n\n最终汇总：\n• 订单总成本 = 物料成本 + 加工成本\n• 在【结算中心】→【订单汇总】中查看',
        },
      ],
    },
    {
      id: 'payroll-operator-summary',
      title: '工资查询汇总（按人员工序）',
      category: 'finance',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['工资查询', '扫码明细', '人员汇总'],
      steps: [
        {
          title: '进入工资查询汇总页面',
          description: '从左侧菜单选择「财务管理」→「工资结算(内)」进入。页面分为两个Tab：「扫码明细」和「人员汇总」。',
          tips: [
            '此页面主要用于查询和核对工资数据，不涉及付款操作',
            '数据来源于小程序扫码记录和PC端扫码记录',
            '默认显示当月数据，可修改日期范围',
          ],
        },
        {
          title: '查看扫码明细',
          description: '在「扫码明细」Tab下，查看每一条扫码记录的详细信息：操作人、订单号、款号、工序名称、数量、单价、金额、扫码时间、扫码类型。',
          tips: [
            '可按订单号、款号、员工姓名、工序名称筛选',
            '扫码类型包括：生产、裁剪、质检、大烫、包装、入库',
            '勾选"包含已结算"可查看已参与工资结算的记录',
            '底部自动汇总显示：总数量和总金额',
          ],
        },
        {
          title: '查看人员汇总',
          description: '切换到「人员汇总」Tab，按员工姓名聚合显示工资数据。每人一行，显示总数量、总金额、涉及订单数等汇总信息。',
          tips: [
            '人员汇总便于快速了解每个工人的工资情况',
            '点击某人可展开查看其工序明细',
            '支持按金额排序，快速找到高/低工资人员',
          ],
        },
        {
          title: '从其他页面跳转查询',
          description: '在生产进度等页面点击"查看工资"链接时，系统会自动跳转到此页面并预填订单号等筛选条件，直接显示相关数据。',
          tips: [
            '从订单维度跳转：自动填入订单号',
            '从工序维度跳转：自动填入工序名称',
            'URL参数支持：orderNo、processName、scanType',
          ],
        },
      ],
      faqs: [
        {
          question: '扫码明细中的"已结算"是什么意思？',
          answer: '💰 已结算 = 该扫码记录已参与工资发放。\n\n状态说明：\n• 未结算：扫码记录已提交，但还没有进行工资结算\n• 已结算：该记录已纳入某次工资结算批次，金额已计入工资表\n\n默认筛选行为：\n• 页面默认只显示"未结算"记录\n• 勾选"包含已结算"可查看所有记录\n• 避免重复结算同一笔扫码记录\n\n⚠️ 注意：已结算的扫码记录不允许撤回，如需修改请联系管理员',
        },
        {
          question: '与实际工资不符怎么核查？',
          answer: '🔍 核查步骤：\n\n1. 在【扫码明细】Tab中输入员工姓名\n2. 设置对应的日期范围（如上月1日-月末）\n3. 查看每条扫码记录：\n   ✓ 工序名称是否正确\n   ✓ 数量是否与实际完成一致\n   ✓ 单价是否正确（对照工序单价表）\n   ✓ 扫码时间是否合理\n4. 对比【人员汇总】中的总金额\n5. 如发现错误：\n   • 未结算记录：可撤回后重新扫码\n   • 已结算记录：联系管理员进行调整',
        },
      ],
    },
    {
      id: 'finance-center',
      title: '结算中心（订单结算）',
      category: 'finance',
      difficulty: 'advanced',
      duration: '10分钟',
      tags: ['订单结算', '成本核算', '利润分析'],
      steps: [
        {
          title: '进入结算中心',
          description: '从左侧菜单选择「财务管理」→「订单结算(外)」进入结算中心。页面包含三个Tab：「订单汇总」、「工厂订单汇总」和「数据看板」。',
          tips: [
            '此页面是财务核心页面，整合了订单级的成本和利润数据',
            '数据来源于采购成本、加工成本、质检损耗等',
            '支持按日期范围和工厂筛选',
          ],
        },
        {
          title: '查看订单汇总',
          description: '在「订单汇总」Tab下，查看每个订单的完整成本结构：面辅料成本、生产成本（工序加工费）、次品损耗、客户售价、利润率。',
          tips: [
            '利润率 =（售价 - 总成本）÷ 售价 × 100%',
            '红色利润率表示亏损，需要重点关注',
            '可点击订单号查看成本明细',
            '支持编辑备注和查看操作日志',
          ],
        },
        {
          title: '查看工厂订单汇总',
          description: '切换到「工厂订单汇总」Tab，按工厂维度聚合所有订单数据。显示每个工厂的订单数、总数量、入库量、次品量、总金额和利润。',
          tips: [
            '用于评估各工厂的合作数据和质量表现',
            '次品率高的工厂需要重点沟通',
            '可按工厂名称搜索快速定位',
          ],
        },
        {
          title: '查看数据看板',
          description: '切换到「数据看板」Tab，通过可视化图表分析经营数据：统计卡片（总金额/入库数量/订单数/利润率+环比变化）、趋势折线图、工厂排名。',
          tips: [
            '支持日/周/月/年/自定义时间范围切换',
            '环比变化显示与上一个周期的对比（↑增长、↓下降）',
            '点击图表中的数据点可查看明细',
            '支持按工厂筛选查看特定工厂的趋势',
          ],
        },
      ],
      faqs: [
        {
          question: '订单利润率为负数说明什么？',
          answer: '🔴 利润率为负 = 该订单亏损。\n\n可能原因：\n1. 面辅料价格上涨导致成本超出预算\n2. 次品率过高，额外返工成本\n3. 工序单价配置过高\n4. 客户售价过低\n\n排查步骤：\n1. 点击订单号查看成本明细\n2. 对比面辅料实际成本与报价时的预估\n3. 检查次品损耗是否异常\n4. 核对工序单价是否与合同一致\n\n优化建议：\n• 报价时预留10-15%利润空间\n• 控制次品率（目标<3%）\n• 定期复核工序单价',
        },
        {
          question: '如何导出结算报表？',
          answer: '📊 导出操作：\n\n订单汇总导出：\n1. 在【订单汇总】Tab中设置筛选条件\n2. 点击右上角【导出】按钮\n3. 选择导出格式（Excel）\n4. 文件自动下载到本地\n\n导出内容包含：\n• 订单号、款号、客户、工厂\n• 面辅料成本、加工成本、次品损耗\n• 售价、利润、利润率\n• 汇总行（总计/平均值）',
        },
      ],
    },
    {
      id: 'expense-reimbursement',
      title: '费用报销管理',
      category: 'finance',
      difficulty: 'intermediate',
      duration: '6分钟',
      tags: ['报销', '费用', '审批'],
      steps: [
        {
          title: '进入费用报销页面',
          description: '从左侧菜单选择「财务管理」→「费用报销」进入。页面有两个视图：「我的报销」（查看自己提交的报销单）和「全部」（审批人查看所有报销单）。',
          tips: [
            '顶部统计卡片显示：待审核数量、报销总金额、已付款金额',
            '普通员工只能看到「我的报销」',
            '有审批权限的用户可切换到「全部」视图',
          ],
        },
        {
          title: '创建报销单',
          description: '点击「+ 新建报销单」按钮，填写报销信息：费用类型（物流费、包装费、维修费等）、金额、支付方式（现金/银行转账/微信/支付宝）、费用日期、供应商（可选）、备注说明。',
          tips: [
            '费用类型从下拉列表中选择（不支持自定义，如需新类型联系管理员）',
            '金额精确到分，如 1234.56',
            '关联供应商后会自动记录供应商信息',
            '备注建议写明费用用途和原因',
          ],
        },
        {
          title: '提交审核',
          description: '报销单创建后默认为"草稿"状态，确认信息无误后点击「提交」按钮，报销单进入审批流程。',
          tips: [
            '草稿状态可以修改和删除',
            '提交后不可修改，如需更改需要先撤回',
            '审批人会收到待审核通知',
          ],
        },
        {
          title: '审批处理（审批人操作）',
          description: '审批人在「全部」视图中，找到待审核的报销单，点击「审批」按钮。可以选择：批准（通过审核）或驳回（填写驳回原因后退回给申请人修改）。',
          tips: [
            '批准后报销单状态变为"已审批"',
            '驳回时必须填写驳回理由',
            '被驳回的报销单可以修改后重新提交',
          ],
        },
        {
          title: '确认付款',
          description: '审批通过后，财务人员点击「确认付款」按钮，完成报销流程。付款记录自动流转到「付款中心」。',
          tips: [
            '付款后报销单状态变为"已付款"',
            '付款记录可在「付款中心」查看详情',
            '已付款的报销单不可再修改',
          ],
        },
      ],
      faqs: [
        {
          question: '报销单被驳回后怎么处理？',
          answer: '🔄 驳回后的处理流程：\n\n1. 在【我的报销】中找到被驳回的报销单（状态显示"已驳回"）\n2. 查看驳回原因（显示在报销单详情中）\n3. 点击【编辑】修改相关信息\n4. 修改完成后点击【重新提交】\n5. 报销单进入新一轮审批流程\n\n💡 常见驳回原因：\n• 金额不正确（重新核对）\n• 缺少发票或凭证（补充上传）\n• 费用类型选错（更正类型）\n• 说明不清楚（补充详细备注）',
        },
        {
          question: '支持的费用类型有哪些？',
          answer: '📋 系统预置费用类型：\n\n• 物流费：快递、运费\n• 包装费：包装材料\n• 维修费：设备维护\n• 办公费：办公用品\n• 差旅费：出差交通住宿\n• 招待费：业务招待\n• 其他：未分类费用\n\n如需新增费用类型：\n联系管理员在【系统设置】→【字典管理】中添加',
        },
      ],
    },
    {
      id: 'wage-payment',
      title: '付款中心使用指南',
      category: 'finance',
      difficulty: 'advanced',
      duration: '8分钟',
      tags: ['付款', '工资发放', '对账付款'],
      steps: [
        {
          title: '进入付款中心页面',
          description: '从左侧菜单选择「财务管理」→「付款中心」进入。页面分为两个Tab：「待付款」（汇聚所有待付款项目）和「支付记录」（已完成的付款历史）。',
          tips: [
            '付款中心统一管理三类付款：工资单、对账单、报销单',
            '待付款列表按来源自动聚合，一目了然',
            '只有财务权限的用户才能操作付款',
          ],
        },
        {
          title: '查看待付款列表',
          description: '「待付款」Tab显示所有待支付项目，来源包括：工资结算、物料对账、费用报销。每条记录显示付款类型、收款方、金额、来源单号。',
          tips: [
            '工资单（PAYROLL）：工人每月工资',
            '对账单（RECONCILIATION）：供应商加工费/物料费',
            '报销单（REIMBURSEMENT）：员工费用报销',
            '可按类型筛选快速找到特定类别的待付款',
          ],
        },
        {
          title: '发起支付',
          description: '选择待付款项目，点击「发起支付」按钮。在弹窗中选择支付方式（线下付款/银行转账/微信/支付宝），选择或新增收款账户，确认金额后提交。',
          tips: [
            '支持部分付款（如工资分批发放）',
            '收款账户可在「账户管理」中预先配置',
            '线下付款需后续上传凭证确认',
            '银行转账会记录交易流水号',
          ],
        },
        {
          title: '上传付款凭证',
          description: '付款完成后，点击「上传凭证」按钮，上传银行转账截图或收据照片作为付款证明。',
          tips: [
            '凭证支持图片格式（JPG/PNG）',
            '建议上传清晰可辨认的转账截图',
            '凭证用于后续审计和对账确认',
          ],
        },
        {
          title: '管理收款账户',
          description: '点击「账户管理」按钮，可新增、编辑、删除常用的收款账户信息（户名、银行、卡号等），避免每次付款重复输入。',
          tips: [
            '账户信息绑定供应商/员工，自动匹配',
            '支持银行卡、微信收款码、支付宝账号',
            '停用的账户可标记为"禁用"但不删除',
          ],
        },
      ],
      faqs: [
        {
          question: '付款中心的待付款项目从哪里来？',
          answer: '📥 待付款自动聚合自多个来源：\n\n来源1 - 工资结算：\n• 【工资结算(内)】中结算生成的工资单\n• 审批通过后自动出现在待付款列表\n\n来源2 - 物料对账：\n• 【物料对账】审批通过的对账单\n• 应付金额自动流转到待付款\n\n来源3 - 费用报销：\n• 【费用报销】审批通过的报销单\n• 确认付款金额后流转到待付款\n\n⚠️ 注意：如果待付款列表为空，说明没有审批通过的待付款项目',
        },
        {
          question: '如何查看历史付款记录？',
          answer: '📋 查看已付款历史：\n\n1. 切换到「支付记录」Tab\n2. 查看所有已完成的付款记录\n3. 每条记录包含：\n   • 支付时间、金额、支付方式\n   • 收款方、收款账户\n   • 来源类型和来源单号\n   • 付款凭证（可点击查看大图）\n4. 支持按时间范围和类型筛选',
        },
      ],
    },
    {
      id: 'supplier-management',
      title: '供应商管理',
      category: 'system',
      difficulty: 'beginner',
      duration: '5分钟',
      tags: ['供应商', '工厂', '基础数据'],
      steps: [
        {
          title: '进入供应商管理页面',
          description: '从左侧菜单选择「系统设置」→「供应商管理」进入。显示所有合作供应商/加工工厂的列表。',
          tips: [
            '供应商信息是基础数据，会在采购、对账等模块中引用',
            '建议先创建供应商，再进行采购和对账操作',
            '支持通过URL参数直接搜索：?factoryName=xxx',
          ],
        },
        {
          title: '创建新供应商',
          description: '点击「+ 新建供应商」按钮，在弹窗中填写：供应商编码（唯一）、供应商名称（必填）、联系人、联系电话、地址等信息。',
          tips: [
            '供应商编码建议统一格式（如GYS001、GYS002）',
            '名称不可重复，用于全系统唯一识别',
            '联系电话用于对账和付款时的快速联系',
          ],
        },
        {
          title: '上传营业执照',
          description: '编辑供应商时，可上传营业执照图片（JPG/PNG，最大5MB），用于企业资质备案。',
          tips: [
            '营业执照用于合规审查和供应商资质管理',
            '上传后可随时查看和更新',
            '建议拍摄清晰正面照片',
          ],
        },
        {
          title: '配置收款账户',
          description: '点击供应商的「收款账户」按钮，添加该供应商的银行账户信息。付款时自动匹配使用这里配置的账户。',
          tips: [
            '可配置多个收款账户（如不同银行）',
            '设置默认账户，付款时自动选中',
            '账户信息修改后对后续付款生效，已完成的付款不受影响',
          ],
        },
        {
          title: '启用/停用供应商',
          description: '点击「更多」→「停用」可暂停与某供应商的合作。停用后该供应商在采购等页面不可选择，但历史数据保留。',
          tips: [
            '停用需要填写操作原因（如合作终止、质量问题）',
            '停用后可随时重新启用',
            '停用不影响已有的采购单和对账单',
          ],
        },
      ],
      faqs: [
        {
          question: '供应商和工厂有什么区别？',
          answer: '🏭 在本系统中，供应商和工厂是同一概念：\n\n• "供应商"是正式名称，指所有合作方\n• "工厂"是习惯称呼，特指加工厂\n• 系统将面辅料供应商和加工工厂统一管理\n• 区分方式：通过备注或标签区分类型\n\n使用场景：\n• 面辅料采购时选择"供应商"\n• 生产订单分配时选择"工厂"\n• 对账时分别对应"物料对账"和"订单结算"',
        },
      ],
    },
    {
      id: 'role-management',
      title: '角色管理与权限配置',
      category: 'system',
      difficulty: 'intermediate',
      duration: '7分钟',
      tags: ['角色', '权限', '安全'],
      steps: [
        {
          title: '进入角色管理页面',
          description: '从左侧菜单选择「系统设置」→「角色管理」进入。显示系统中所有角色的列表。',
          tips: [
            '角色决定用户能看到哪些菜单和执行哪些操作',
            '系统预置了几个默认角色，可基于此修改',
            '建议按照岗位职责划分角色（如生产主管、财务、仓管）',
          ],
        },
        {
          title: '创建新角色',
          description: '点击「+ 新建角色」按钮，填写角色名称和描述。角色名称应简洁明了（如"财务人员"、"车间主管"）。',
          tips: [
            '角色名称不可重复',
            '描述中写明该角色的适用岗位和主要职责',
            '创建后需配置权限才能使用',
          ],
        },
        {
          title: '配置权限（核心步骤）',
          description: '点击角色的「权限配置」按钮，打开权限树。勾选该角色需要的菜单权限和操作权限。支持关键词搜索快速定位权限项。',
          tips: [
            '权限树按模块分组：样衣管理、生产管理、仓库管理、财务管理、系统设置',
            '勾选父级菜单会自动勾选所有子菜单',
            '搜索框输入关键词可快速过滤权限项',
            '修改后点击「保存」立即生效（已登录用户需重新登录）',
          ],
        },
        {
          title: '使用权限模板（快速配置）',
          description: '权限配置界面提供预设的权限模板，一键应用常用角色配置：系统管理员（全量权限）、生产人员、财务人员、普通用户、系统设置。',
          tips: [
            '选择模板后会自动勾选对应的权限项',
            '可在模板基础上微调（新增或去除部分权限）',
            '模板只是快速填充工具，不会覆盖已有自定义配置',
          ],
        },
      ],
      faqs: [
        {
          question: '如何为不同岗位配置合理的权限？',
          answer: '🔐 推荐的角色权限配置：\n\n管理员/老板：\n• 所有菜单和操作权限\n• 数据范围：全部\n\n生产主管：\n• 样衣管理（全部）\n• 生产管理（全部）\n• 仓库管理（查看）\n• 数据范围：全部或本工厂\n\n财务人员：\n• 财务管理（全部）\n• 生产管理（查看，不可编辑）\n• 仓库管理（查看）\n• 数据范围：全部\n\n仓管人员：\n• 仓库管理（全部）\n• 生产管理（查看质检入库）\n• 数据范围：全部\n\n普通车间工人：\n• 仅小程序扫码权限\n• PC端无权限或仅查看仪表盘',
        },
        {
          question: '删除角色会影响已分配该角色的用户吗？',
          answer: '⚠️ 删除角色前请谨慎确认：\n\n删除后果：\n• 所有已分配该角色的用户将失去该角色对应的权限\n• 用户下次刷新或重新登录时，菜单和操作权限立即缩减\n• 如果用户只有这一个角色，将变为"无权限"状态\n\n安全操作建议：\n1. 删除前先查看该角色下有多少用户\n2. 先将用户转移到其他角色\n3. 确认无用户后再删除角色\n4. 或者使用"禁用"代替"删除"（保留数据）',
        },
      ],
    },
    {
      id: 'system-logs',
      title: '系统日志查看',
      category: 'system',
      difficulty: 'beginner',
      duration: '4分钟',
      tags: ['日志', '审计', '安全'],
      steps: [
        {
          title: '进入系统日志页面',
          description: '从左侧菜单选择「系统设置」→「系统日志」进入。页面分为两个Tab：「登录日志」和「操作日志」。',
          tips: [
            '系统日志用于安全审计和问题排查',
            '建议管理员定期查看，及时发现异常行为',
            '日志自动记录，无需手动操作',
          ],
        },
        {
          title: '查看登录日志',
          description: '在「登录日志」Tab下，查看所有用户的登录记录：用户名、姓名、登录IP地址、登录时间、登录状态（成功/失败）。',
          tips: [
            '登录失败记录可发现异常登录尝试',
            '同一账号频繁失败可能是密码被猜测（建议修改密码）',
            '陌生IP登录需要核实是否为本人操作',
            '支持按日期范围筛选',
          ],
        },
        {
          title: '查看操作日志',
          description: '在「操作日志」Tab下，查看系统中的关键操作记录：操作类型、操作人、操作时间、操作详情（JSON格式可展开查看完整数据）。',
          tips: [
            '操作日志记录增删改等关键操作',
            '点击「详情」可展开查看操作的完整数据（修改前后对比）',
            '用于追溯"谁在什么时间做了什么操作"',
          ],
        },
      ],
      faqs: [
        {
          question: '发现可疑登录怎么处理？',
          answer: '🚨 安全处置步骤：\n\n1. 确认可疑记录：\n   • IP地址不在常用地区\n   • 非工作时间段登录\n   • 短时间内多次登录失败\n\n2. 立即处理：\n   • 修改受影响账号的密码\n   • 如怀疑被盗，先禁用该账号\n   • 通知该用户确认是否为本人操作\n\n3. 后续措施：\n   • 要求用户使用更复杂的密码\n   • 检查该账号的操作日志，确认是否有异常操作\n   • 必要时联系技术支持排查',
        },
      ],
    },
    {
      id: 'user-profile',
      title: '个人中心使用指南',
      category: 'system',
      difficulty: 'beginner',
      duration: '3分钟',
      tags: ['个人信息', '密码修改', '账单'],
      steps: [
        {
          title: '进入个人中心',
          description: '点击页面右上角的用户头像/昵称，选择「个人中心」进入。或从左侧菜单选择「系统设置」→「个人中心」。',
          tips: [
            '每个用户都可以访问自己的个人中心',
            '不需要特殊权限',
          ],
        },
        {
          title: '查看和修改个人信息',
          description: '在「个人信息」Tab下，查看和修改你的姓名、手机号、邮箱等基本信息。也可以在此处修改登录密码。',
          tips: [
            '修改密码需要输入旧密码验证身份',
            '新密码建议6位以上，包含数字和字母',
            '手机号修改后用于接收系统通知',
          ],
        },
        {
          title: '查看我的账单',
          description: '在「我的账单」Tab下，查看个人相关的账单和发票信息（付费用户可见）。',
          tips: [
            '账单按月汇总显示',
            '可下载电子发票',
            '如对账单有疑问，联系管理员核实',
          ],
        },
      ],
      faqs: [
        {
          question: '如何修改登录密码？',
          answer: '🔑 修改密码步骤：\n\n1. 点击右上角头像 → 选择【个人中心】\n2. 在「个人信息」Tab中找到"密码修改"区域\n3. 输入当前密码（验证身份）\n4. 输入新密码（建议6位以上，包含数字和字母）\n5. 再次确认新密码\n6. 点击【保存】完成修改\n7. 下次登录使用新密码\n\n⚠️ 如果忘记当前密码：\n• 联系管理员在【人员管理】中重置密码\n• 管理员重置后使用新密码登录',
        },
      ],
    },
    {
      id: 'data-import',
      title: 'Excel数据批量导入',
      category: 'system',
      difficulty: 'intermediate',
      duration: '6分钟',
      tags: ['数据导入', 'Excel', '批量'],
      steps: [
        {
          title: '进入数据导入页面',
          description: '从左侧菜单选择「系统设置」→「数据导入」进入。页面提供5种导入方式：款式资料、供应商、员工、工序、ZIP打包导入。通过顶部Tab切换不同导入类型。',
          tips: [
            '首次使用系统时，建议按此顺序导入：供应商 → 员工 → 款式资料 → 工序',
            '数据导入是"增量"操作，不会覆盖已有数据',
            '如遇到重复数据（如同款号），该行会报错跳过',
          ],
        },
        {
          title: '下载Excel模板',
          description: '选择要导入的数据类型Tab（如「款式资料」），点击「📥 下载模板」按钮，获取标准Excel模板。',
          tips: [
            '每种类型有专属模板，字段和格式不同',
            '模板包含表头说明和示例数据，参考填写',
            '不要修改模板的表头行（第一行），否则导入失败',
          ],
        },
        {
          title: '填写Excel数据',
          description: '在下载的模板中按要求填写数据。带*号的字段为必填项。',
          tips: [
            '款式资料：款号*（唯一）、款名、品类、颜色、码数',
            '供应商：供应商名称*（唯一）、联系人、联系电话、地址',
            '员工：姓名*、手机号*（唯一）、角色，系统自动创建账号（默认密码123456）',
            '工序：款号*（必须已存在）、工序名称*、工时分钟、工序单价',
            '单次最多导入500条数据',
          ],
        },
        {
          title: '上传并导入',
          description: '点击「📤 上传并导入」按钮，选择填写好的Excel文件。系统自动验证数据格式和唯一性约束，显示导入进度条。',
          tips: [
            '支持 .xlsx 和 .xls 格式',
            '文件大小限制：单个Excel文件50MB以内',
            '导入过程中请勿关闭页面',
          ],
        },
        {
          title: '查看导入结果',
          description: '导入完成后，页面显示导入结果：成功条数、失败条数。失败的行会列出行号和具体错误原因（如"款号已存在""手机号重复"），可根据错误提示修正后重新导入。',
          tips: [
            '成功导入的数据立即在对应模块中可见',
            '失败的行不影响成功行的导入',
            '常见错误：必填字段为空、唯一字段重复、款号不存在（工序导入时）',
          ],
        },
        {
          title: 'ZIP打包导入（高级）',
          description: '切换到「ZIP 打包导入」Tab，可一次性导入款式Excel + 款式封面图片。将Excel文件和图片文件打包为.zip上传，图片命名需与款号一致（如HYY20222.jpg）。',
          tips: [
            'ZIP包结构：根目录放Excel文件 + 同级放图片文件',
            '图片命名规则：款号.jpg 或 款号.png（如HYY20222.jpg）',
            'ZIP最大500MB，含图片时注意压缩',
            '图片会自动关联到对应款式作为封面图',
          ],
        },
      ],
      faqs: [
        {
          question: '导入员工后如何设置权限？',
          answer: '👥 员工导入后的后续操作：\n\n导入时自动完成的：\n• 创建登录账号（用户名=emp_+手机号后4位）\n• 设置默认密码（123456）\n• 账号状态=启用\n\n导入后需手动操作的：\n1. 进入【系统设置】→【人员管理】\n2. 找到新导入的员工\n3. 点击【编辑】→ 分配角色\n4. 选择合适的角色（如"生产人员"）\n5. 保存，通知员工使用账号和默认密码登录\n6. 提醒员工首次登录后修改密码',
        },
        {
          question: '导入的工序如何与款式关联？',
          answer: '🔗 工序导入必须关联已有款式：\n\n前提条件：\n• 款式资料已录入系统（手动创建或Excel导入）\n• 工序模板Excel中的"款号"列必须与系统中的款号完全一致\n\n导入逻辑：\n1. 系统读取Excel中的"款号"列\n2. 查找系统中是否存在该款号\n3. 存在 → 将工序添加到该款式的工序列表\n4. 不存在 → 该行报错"款号不存在"\n\n⚠️ 导入顺序很重要：\n先导入款式资料 → 再导入工序模板\n如果反过来，所有工序行都会报错',
        },
      ],
    },
    {
      id: 'app-store',
      title: '应用商店',
      category: 'system',
      difficulty: 'beginner',
      duration: '3分钟',
      tags: ['应用商店', '扩展', '订阅'],
      steps: [
        {
          title: '进入应用商店',
          description: '在左侧菜单底部找到「🛒 应用商店」，点击进入。应用商店展示可用的功能扩展和增值服务。',
          tips: [
            '应用商店是独立的顶级菜单，不在某个模块下',
            '部分应用为免费功能，部分为付费增值服务',
            '已安装的应用会显示"已启用"标记',
          ],
        },
        {
          title: '浏览和搜索应用',
          description: '在应用商店中浏览可用的功能扩展，按类别筛选或搜索关键词查找特定应用。',
          tips: [
            '应用按类别分组（生产增强/财务增强/数据分析等）',
            '每个应用都有详细的功能介绍和使用说明',
            '查看其他用户的评价和使用反馈',
          ],
        },
        {
          title: '安装/订阅应用',
          description: '点击应用卡片上的「安装」或「订阅」按钮。免费应用直接安装启用，付费应用需完成支付后启用。',
          tips: [
            '安装后对应功能会出现在系统菜单中',
            '付费应用支持按月/按年订阅',
            '可随时取消订阅（当期有效期内仍可使用）',
          ],
        },
      ],
      faqs: [
        {
          question: '卸载应用会丢失数据吗？',
          answer: '📦 分应用而定：\n\n大部分应用：\n• 卸载后菜单入口消失\n• 已产生的数据保留在数据库中\n• 重新安装后数据自动恢复\n\n⚠️ 极少数应用可能有特殊说明：\n• 卸载前查看应用详情中的"卸载须知"\n• 建议卸载前导出重要数据',
        },
      ],
    },
  ];

  // 分类定义
  const categories = [
    { key: 'all', label: '全部教程', icon: <BookOutlined /> },
    { key: 'getting-started', label: '入门指南', icon: <RocketOutlined /> },
    { key: 'sample', label: '样衣管理', icon: <FileTextOutlined /> },
    { key: 'production', label: '生产管理', icon: <RocketOutlined /> },
    { key: 'warehouse', label: '仓储管理', icon: <BulbOutlined /> },
    { key: 'mobile', label: '小程序操作', icon: <VideoCameraOutlined /> },
    { key: 'finance', label: '财务管理', icon: <FileTextOutlined /> },
    { key: 'system', label: '系统设置', icon: <ThunderboltOutlined /> },
  ];

  // 难度标签样式
  const getDifficultyTag = (difficulty: string) => {
    const configs = {
      beginner: { label: '入门', color: 'green' },
      intermediate: { label: '进阶', color: 'orange' },
      advanced: { label: '高级', color: 'red' },
    };
    const config = configs[difficulty as keyof typeof configs] || configs.beginner;
    return <Tag color={config.color}>{config.label}</Tag>;
  };

  // 搜索和筛选
  useEffect(() => {
    let result = tutorials;

    // 分类筛选
    if (activeCategory !== 'all') {
      result = result.filter((t) => t.category === activeCategory);
    }

    // 搜索筛选
    if (searchText.trim()) {
      const search = searchText.toLowerCase();
      result = result.filter(
        (t) =>
          t.title.toLowerCase().includes(search) ||
          t.tags.some((tag) => tag.toLowerCase().includes(search)) ||
          t.steps.some((step) => step.title.toLowerCase().includes(search))
      );
    }

    setFilteredTutorials(result);
  }, [activeCategory, searchText]);

  return (
    <Layout>
      <div className="system-tutorial-container">
        {/* 页面头部 */}
        <div className="tutorial-page-header">
          <div className="header-content">
            <div className="tutorial-title-section">
              <BookOutlined className="tutorial-header-icon" />
              <div>
                <h2 className="tutorial-page-title">系统教学中心</h2>
                <Text type="secondary">从入门到精通，快速掌握服装供应链管理系统</Text>
              </div>
            </div>
          </div>
      </div>

      {/* 快速指引 */}
      <Alert
        title="💡 新手指引"
        description={
          <div>
            <p style={{ marginBottom: 8 }}>
              <strong>建议学习路径：</strong>
            </p>
            <Timeline
              items={[
                { content: '1️⃣ 先学习「生产订单创建」和「人员与权限管理」了解系统基础' },
                { content: '2️⃣ 掌握「裁剪单生成」和「小程序扫码工序」进行实操练习' },
                { content: '3️⃣ 学习「质检入库」和「面辅料管理」完善生产流程' },
                { content: '4️⃣ 最后学习「对账与财务结算」掌握完整业务闭环' },
              ]}
            />
          </div>
        }
        type="info"
        showIcon
        style={{ marginBottom: 24 }}
      />

      {/* 搜索和分类 */}
      <Card style={{ marginBottom: 24 }}>
        <Space orientation="vertical" size={16} style={{ width: '100%' }}>
          <StandardSearchBar
            searchValue={searchText}
            onSearchChange={setSearchText}
            searchPlaceholder="搜索教程标题、标签或步骤"
            dateValue={dateRange}
            onDateChange={setDateRange}
            statusValue={activeCategory}
            onStatusChange={setActiveCategory}
            statusOptions={categories.map((cat) => ({
              label: cat.label,
              value: cat.key,
            }))}
          />
          <Space wrap size={[12, 12]}>
            {categories.map((cat) => (
              <Button
                key={cat.key}
                type={activeCategory === cat.key ? 'primary' : 'default'}
                icon={cat.icon}
                onClick={() => setActiveCategory(cat.key)}
              >
                {cat.label}
              </Button>
            ))}
          </Space>
        </Space>
      </Card>

      {/* 教程列表 */}
      {filteredTutorials.length === 0 ? (
        <Card>
          <Empty description="未找到相关教程，请尝试其他关键词" />
        </Card>
      ) : (
        <Row gutter={[16, 16]}>
          {filteredTutorials.map((tutorial) => (
            <Col xs={24} key={tutorial.id}>
              <Card
                className="tutorial-card"
                title={
                  <Space>
                    <FileTextOutlined />
                    <span>{tutorial.title}</span>
                    {getDifficultyTag(tutorial.difficulty)}
                    <Tag>{tutorial.duration}</Tag>
                  </Space>
                }
                extra={
                  <Space>
                    {tutorial.tags.map((tag) => (
                      <Tag key={tag} color="blue">
                        {tag}
                      </Tag>
                    ))}
                  </Space>
                }
              >
                <Tabs
                  defaultActiveKey="steps"
                  items={[
                    {
                      key: 'steps',
                      label: '📖 操作步骤',
                      children: (
                        <Steps
                          orientation="vertical"
                          current={-1}
                          items={tutorial.steps.map((step, index) => ({
                            title: (
                              <Space>
                                <Badge count={index + 1} style={{ backgroundColor: 'var(--color-success)' }} />
                                <strong>{step.title}</strong>
                              </Space>
                            ),
                            content: (
                              <div style={{ paddingLeft: 30 }}>
                                <Paragraph>{step.description}</Paragraph>
                                {step.tips && step.tips.length > 0 && (
                                  <Alert
                                    title="💡 温馨提示"
                                    description={
                                      <ul style={{ margin: '8px 0', paddingLeft: 20 }}>
                                        {step.tips.map((tip, i) => (
                                          <li key={i}>{tip}</li>
                                        ))}
                                      </ul>
                                    }
                                    type="success"
                                    showIcon
                                    style={{ marginTop: 12 }}
                                  />
                                )}
                                {step.image && (
                                  <Image
                                    src={step.image}
                                    alt={step.title}
                                    style={{ marginTop: 12, maxWidth: 600 }}
                                    preview
                                  />
                                )}
                              </div>
                            ),
                            status: 'finish',
                          }))}
                        />
                      ),
                    },
                    ...(tutorial.faqs && tutorial.faqs.length > 0 ? [{
                      key: 'faqs',
                      label: '❓ 常见问题',
                      children: (
                        <Collapse
                          accordion
                          items={tutorial.faqs.map((faq, index) => ({
                            key: index,
                            label: (
                              <Space>
                                <QuestionCircleOutlined style={{ color: 'var(--color-warning)' }} />
                                <strong>{faq.question}</strong>
                              </Space>
                            ),
                            children: <Alert title={faq.answer} type="info" showIcon />
                          }))}
                        />
                      ),
                    }] : []),
                    ...(tutorial.videoUrl ? [{
                      key: 'video',
                      label: '🎬 视频教程',
                      children: <VideoPlayerBlock url={tutorial.videoUrl} />,
                    }] : []),
                  ]}
                />
              </Card>
            </Col>
          ))}
        </Row>
      )}

      {/* 底部帮助 */}
      <Card style={{ marginTop: 24 }}>
        <Space orientation="vertical" size={12} style={{ width: '100%' }}>
          <Title level={4}>
            <QuestionCircleOutlined /> 需要更多帮助？
          </Title>
          <Paragraph>
            • <strong>在线客服：</strong>点击右下角客服图标，实时咨询技术支持
            <br />
            • <strong>用户手册：</strong>下载完整PDF用户手册，离线查阅
            <br />
            • <strong>培训预约：</strong>联系管理员预约一对一系统培训
            <br />• <strong>反馈建议：</strong>
            发现问题或有改进建议？点击「意见反馈」告诉我们
          </Paragraph>
          <Space>
            <Button type="primary">
              下载用户手册
            </Button>
            <Button>意见反馈</Button>
          </Space>
        </Space>
      </Card>
      </div>
    </Layout>
  );
};

export default SystemTutorial;
