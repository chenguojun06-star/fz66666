# ğŸ“¦ åº”ç”¨å•†åº—ä¸APIå¯¹æ¥å®Œæ•´ä½¿ç”¨æ•™ç¨‹

> **é€‚ç”¨ç‰ˆæœ¬**ï¼šv3.4+ | **æœ€åæ›´æ–°**ï¼š2026-02-11
> **æ–‡æ¡£èŒƒå›´**ï¼šåº”ç”¨è´­ä¹° â†’ è¯•ç”¨æ¿€æ´» â†’ APIå¯¹æ¥ â†’ æ•°æ®åŒæ­¥ â†’ å¤šç§Ÿæˆ·éš”ç¦»

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ€»è§ˆ](#1-ç³»ç»Ÿæ€»è§ˆ)
2. [åº”ç”¨å•†åº—è´­ä¹°æµç¨‹](#2-åº”ç”¨å•†åº—è´­ä¹°æµç¨‹)
3. [é¡µé¢ä½ç½®ä¸å…¥å£å¯¼èˆª](#3-é¡µé¢ä½ç½®ä¸å…¥å£å¯¼èˆª)
4. [å››å¤§å¯¹æ¥æ¨¡å—è¯¦è§£](#4-å››å¤§å¯¹æ¥æ¨¡å—è¯¦è§£)
5. [APIå¯¹æ¥å¼€å‘æŒ‡å—](#5-apiå¯¹æ¥å¼€å‘æŒ‡å—)
6. [æ•°æ®æ‹‰å–ï¼ˆPullï¼‰æœºåˆ¶](#6-æ•°æ®æ‹‰å–pullæœºåˆ¶)
7. [Webhookæ¨é€ï¼ˆPushï¼‰æœºåˆ¶](#7-webhookæ¨é€pushæœºåˆ¶)
8. [å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»è¯´æ˜](#8-å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»è¯´æ˜)
9. [å®Œæ•´å¯¹æ¥æµç¨‹å›¾](#9-å®Œæ•´å¯¹æ¥æµç¨‹å›¾)
10. [å¸¸è§é—®é¢˜FAQ](#10-å¸¸è§é—®é¢˜faq)

---

## 1. ç³»ç»Ÿæ€»è§ˆ

### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœè£…ä¾›åº”é“¾ç®¡ç†ç³»ç»Ÿï¼ˆSaaSï¼‰                      â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ åº”ç”¨å•†åº—  â”‚â”€â”€â”€â†’â”‚ è‡ªåŠ¨åˆ›å»ºå‡­è¯  â”‚â”€â”€â”€â†’â”‚ OpenAPI å¯¹æ¥ç½‘å…³   â”‚      â”‚
â”‚  â”‚ (è´­ä¹°/è¯•ç”¨)â”‚    â”‚ (appKey/Secret)â”‚    â”‚ (HMAC-SHA256é‰´æƒ) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                               â”‚                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚              â”‚                â”‚               â”‚          â”‚       â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”  â”‚
â”‚        â”‚ ä¸‹å•å¯¹æ¥   â”‚  â”‚ è´¨æ£€åé¦ˆ    â”‚  â”‚ç‰©æµå¯¹æ¥ â”‚ â”‚ä»˜æ¬¾å¯¹æ¥â”‚  â”‚
â”‚        â”‚ORDER_SYNC  â”‚  â”‚QUALITY_     â”‚  â”‚LOGISTICSâ”‚ â”‚PAYMENT â”‚  â”‚
â”‚        â”‚            â”‚  â”‚ FEEDBACK    â”‚  â”‚ _SYNC   â”‚ â”‚ _SYNC  â”‚  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»å±‚ (tenantId + createdByNameæ ‡è®°è¿‡æ»¤)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†• Push/Pull            â†• Webhook              â†• å›è°ƒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¢æˆ·ERPç³»ç»ŸA  â”‚  â”‚ å®¢æˆ·ERPç³»ç»ŸB  â”‚  â”‚ å®¢æˆ·çº¸æ ·/åˆ¶å•ç³»ç»Ÿ    â”‚
â”‚ (ç§Ÿæˆ·1)       â”‚  â”‚ (ç§Ÿæˆ·2)       â”‚  â”‚ (é€šè¿‡Pullæ‹‰å–æ•°æ®)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¦‚å¿µ

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| **åº”ç”¨å•†åº—** | ç®¡ç†åå°çš„åº”ç”¨å¸‚åœºï¼Œå¯è´­ä¹°/è¯•ç”¨4ç§å¯¹æ¥æ¨¡å— |
| **TenantApp** | ç§Ÿæˆ·çš„APIå¯¹æ¥å‡­è¯ï¼ˆappKey + appSecretï¼‰ï¼Œè´­ä¹°/è¯•ç”¨è‡ªåŠ¨åˆ›å»º |
| **appKey** | APIè°ƒç”¨çš„èº«ä»½æ ‡è¯†ï¼ˆå…¬å¼€ï¼‰ |
| **appSecret** | APIè°ƒç”¨çš„ç­¾åå¯†é’¥ï¼ˆä¿å¯†ï¼Œä»…åˆ›å»ºæ—¶æ˜¾ç¤ºä¸€æ¬¡ï¼‰ |
| **Webhook** | ç³»ç»Ÿä¸»åŠ¨æ¨é€æ•°æ®åˆ°å®¢æˆ·ç³»ç»Ÿï¼ˆå‡ºåº“ã€è®¢å•å®Œæˆã€å¯¹è´¦å®¡æ‰¹ï¼‰ |
| **Pull** | é€šè¿‡APIä»å®¢æˆ·ç³»ç»Ÿæ‹‰å–æ•°æ®ï¼ˆçº¸æ ·ã€åˆ¶å•ï¼‰ |
| **å¤šç§Ÿæˆ·éš”ç¦»** | æ¯ä¸ªç§Ÿæˆ·åªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®ï¼Œé€šè¿‡tenantIdå’ŒcreatedByNameåŒé‡è¿‡æ»¤ |

---

## 2. åº”ç”¨å•†åº—è´­ä¹°æµç¨‹

### 2.1 è´­ä¹°/è¯•ç”¨å…¨æµç¨‹

```
ç”¨æˆ·ç™»å½•ç®¡ç†åå°
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿç®¡ç† â†’ åº”ç”¨å•†åº—  â”‚  è·¯å¾„: /system/app-store
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æµè§ˆ4æ¬¾å¯¹æ¥åº”ç”¨      â”‚
â”‚  Â· ä¸‹å•å¯¹æ¥ Â¥999/æœˆ  â”‚
â”‚  Â· è´¨æ£€åé¦ˆ Â¥799/æœˆ  â”‚
â”‚  Â· ç‰©æµå¯¹æ¥ Â¥799/æœˆ  â”‚
â”‚  Â· ä»˜æ¬¾å¯¹æ¥ Â¥999/æœˆ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…è´¹è¯•ç”¨â”‚ â”‚ ç«‹å³è´­ä¹°â”‚
â”‚ (7å¤©)  â”‚ â”‚        â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚          â”‚
    â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç³»ç»Ÿè‡ªåŠ¨åˆ›å»º:          â”‚
â”‚ 1. TenantSubscription â”‚  â† è®¢é˜…è®°å½•
â”‚ 2. TenantApp          â”‚  â† APIå‡­è¯ï¼ˆappKey/appSecretï¼‰
â”‚ 3. è¿”å›å¯†é’¥ï¼ˆä»…ä¸€æ¬¡ï¼‰   â”‚  â† âš ï¸ å¿…é¡»ä¿å­˜ï¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¢æˆ·æ‹¿åˆ°å‡­è¯åå¯:      â”‚
â”‚ Â· è°ƒç”¨OpenAPIæ¨é€è®¢å•  â”‚
â”‚ Â· é…ç½®Webhookæ¥æ”¶æ¨é€  â”‚
â”‚ Â· é€šè¿‡Pullæ‹‰å–çº¸æ ·æ•°æ® â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¯•ç”¨è§„åˆ™

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| è¯•ç”¨æœŸé™ | **7å¤©**ï¼ˆä»å¼€é€šæ—¶åˆ»èµ·ç®—ï¼‰ |
| è¯•ç”¨æ¬¡æ•° | æ¯ä¸ªç§Ÿæˆ·æ¯ä¸ªåº”ç”¨**ä»…é™ä¸€æ¬¡** |
| APIè°ƒç”¨é™åˆ¶ | è¯•ç”¨æœŸé—´æ¯æ—¥**100æ¬¡**è°ƒç”¨ |
| åŠŸèƒ½é™åˆ¶ | åŠŸèƒ½å®Œå…¨å¼€æ”¾ï¼Œæ— é˜‰å‰² |
| è¯•ç”¨ç»“æŸ | è‡ªåŠ¨è¿‡æœŸï¼ŒAPIå‡­è¯å¤±æ•ˆï¼Œæ•°æ®ä¿ç•™ |
| æ­£å¼è´­ä¹° | å¯å‡çº§ä¸ºæœˆä»˜/å¹´ä»˜ï¼Œæ–°å‡­è¯æˆ–ç»­æœŸ |

### 2.3 è´­ä¹°æ“ä½œæ­¥éª¤

1. **è¿›å…¥åº”ç”¨å•†åº—**ï¼šå·¦ä¾§èœå• â†’ ã€Œåº”ç”¨å•†åº—ã€ğŸ›’
2. **é€‰æ‹©åº”ç”¨**ï¼šç‚¹å‡»åº”ç”¨å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
3. **å¼€é€šè¯•ç”¨**ï¼šç‚¹å‡»ã€Œå…è´¹è¯•ç”¨7å¤©ã€æŒ‰é’®
4. **âš ï¸ ä¿å­˜å¯†é’¥**ï¼šå¼¹çª—æ˜¾ç¤º appKey å’Œ appSecretï¼Œ**åŠ¡å¿…ä¿å­˜**
5. **é…ç½®å¯¹æ¥**ï¼šè¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€é…ç½®å›è°ƒURLç­‰
6. **å¼€å§‹ä½¿ç”¨**ï¼šæŒ‰æœ¬æ–‡æ¡£çš„APIè¯´æ˜è¿›è¡Œå¯¹æ¥

---

## 3. é¡µé¢ä½ç½®ä¸å…¥å£å¯¼èˆª

### 3.1 PCç«¯ç®¡ç†åå°é¡µé¢

| é¡µé¢åç§° | èœå•è·¯å¾„ | URLè·¯å¾„ | æƒé™ç  | åŠŸèƒ½è¯´æ˜ |
|---------|---------|---------|--------|---------|
| åº”ç”¨å•†åº— | ç³»ç»Ÿç®¡ç† â†’ åº”ç”¨å•†åº— | `/system/app-store` | `MENU_APP_STORE_VIEW` | æµè§ˆã€è´­ä¹°ã€è¯•ç”¨åº”ç”¨ |
| å®¢æˆ·åº”ç”¨ç®¡ç† | ç³»ç»Ÿç®¡ç† â†’ å®¢æˆ·åº”ç”¨ç®¡ç† | `/system/tenant-management` | `MENU_TENANT_APP_VIEW` | ç®¡ç†å·²è´­åº”ç”¨ã€APIå‡­è¯ã€æ—¥å¿— |
| é›†æˆæ€»è§ˆ | å®¢æˆ·åº”ç”¨ç®¡ç† â†’ é›†æˆæ€»è§ˆTab | `/system/tenant-management` (Tab) | åŒä¸Š | æŸ¥çœ‹4æ¨¡å—è¿æ¥çŠ¶æ€ã€å¿«é€Ÿå‚è€ƒ |
| ç”Ÿäº§è®¢å• | ç”Ÿäº§ç®¡ç† â†’ ç”Ÿäº§è®¢å• | `/production` | `MENU_PRODUCTION_ORDER_VIEW` | æŸ¥çœ‹é€šè¿‡APIåˆ›å»ºçš„è®¢å•ï¼ˆæ ‡è®°OpenAPI-*ï¼‰ |
| å…¥åº“è´¨æ£€ | ç”Ÿäº§ç®¡ç† â†’ å…¥åº“ç®¡ç† | `/production/warehousing` | `MENU_WAREHOUSE_VIEW` | æŸ¥çœ‹è´¨æ£€æ•°æ®ï¼ˆå¯æ¨é€ç»™å®¢æˆ·ï¼‰ |
| æˆå“å‡ºåº“ | ä»“åº“ç®¡ç† â†’ æˆå“ä»“åº“ | `/warehouse/finished` | `MENU_FINISHED_GOODS_VIEW` | å‡ºåº“æ—¶è‡ªåŠ¨æ¨é€ç‰©æµä¿¡æ¯ |
| è´¢åŠ¡ä¸­å¿ƒ | è´¢åŠ¡ç®¡ç† â†’ è´¢åŠ¡ä¸­å¿ƒ | `/finance/center` | `MENU_FINANCE_VIEW` | å¯¹è´¦å®¡æ‰¹åè‡ªåŠ¨æ¨é€ |

### 3.2 èœå•å¯¼èˆªå›¾

```
å·¦ä¾§èœå•æ 
â”‚
â”œâ”€â”€ ğŸ“Š æ•°æ®é¢æ¿
â”œâ”€â”€ ğŸ‘— æ¬¾å¼ç®¡ç†
â”œâ”€â”€ ğŸ­ ç”Ÿäº§ç®¡ç†
â”‚   â”œâ”€â”€ ç”Ÿäº§è®¢å•          â† é€šè¿‡APIåˆ›å»ºçš„è®¢å•åœ¨è¿™é‡ŒæŸ¥çœ‹
â”‚   â”œâ”€â”€ è£å‰ªç®¡ç†
â”‚   â””â”€â”€ å…¥åº“ç®¡ç†          â† è´¨æ£€æ•°æ®æ¨é€æº
â”œâ”€â”€ ğŸ“¦ ä»“åº“ç®¡ç†
â”‚   â””â”€â”€ æˆå“ä»“åº“          â† å‡ºåº“æ¨é€ç‰©æµä¿¡æ¯
â”œâ”€â”€ ğŸ’° è´¢åŠ¡ç®¡ç†
â”‚   â””â”€â”€ è´¢åŠ¡ä¸­å¿ƒ          â† å¯¹è´¦å®¡æ‰¹æ¨é€
â”œâ”€â”€ âš™ï¸ ç³»ç»Ÿè®¾ç½®
â”‚
â”œâ”€â”€ ğŸ›’ åº”ç”¨å•†åº—            â† â‘  è´­ä¹°å¯¹æ¥åº”ç”¨ï¼
â”‚
â””â”€â”€ ğŸ“± å®¢æˆ·åº”ç”¨ç®¡ç†        â† â‘¡ ç®¡ç†APIå‡­è¯å’Œæ—¥å¿—ï¼
    â”œâ”€â”€ [é›†æˆæ€»è§ˆTab]       â† æŸ¥çœ‹è¿æ¥çŠ¶æ€
    â”œâ”€â”€ [æˆ‘çš„åº”ç”¨Tab]       â† ç®¡ç†appKey/Secret
    â””â”€â”€ [æ—¥å¿—æŸ¥è¯¢Tab]       â† APIè°ƒç”¨æ—¥å¿—
```

---

## 4. å››å¤§å¯¹æ¥æ¨¡å—è¯¦è§£

### 4.1 ä¸‹å•å¯¹æ¥ï¼ˆORDER_SYNCï¼‰

**ç”¨é€”**ï¼šå®¢æˆ·ERPç³»ç»Ÿ â†’ è‡ªåŠ¨æ¨é€è®¢å•åˆ°æœ¬ç³»ç»Ÿ

**æ•°æ®æµå‘**ï¼š
```
å®¢æˆ·ERP/ä¸‹å•ç³»ç»Ÿ                     æˆ‘ä»¬çš„ç”Ÿäº§ç³»ç»Ÿ
      â”‚                                    â”‚
      â”‚  POST /openapi/v1/orders/create    â”‚
      â”‚  (è®¢å•å·ã€æ¬¾å¼ã€é¢œè‰²ã€å°ºç ã€æ•°é‡)    â”‚
      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
      â”‚                                    â”‚ è‡ªåŠ¨åˆ›å»º:
      â”‚                                    â”‚ Â· ç”Ÿäº§è®¢å• (ProductionOrder)
      â”‚     â† è¿”å›ç³»ç»Ÿè®¢å•å· PO202602110001â”‚ Â· æ ‡è®° createdByName="OpenAPI-ä¸‹å•å¯¹æ¥"
      â”‚                                    â”‚
      â”‚  GET /openapi/v1/orders/{orderNo}  â”‚
      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
      â”‚     â† è¿”å›è®¢å•è¿›åº¦ã€çŠ¶æ€             â”‚
      â”‚                                    â”‚
      â”‚  POST /openapi/v1/orders/list      â”‚
      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
      â”‚     â† è¿”å›è¯¥åº”ç”¨åˆ›å»ºçš„æ‰€æœ‰è®¢å•åˆ—è¡¨    â”‚
```

**APIç«¯ç‚¹**ï¼š
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/openapi/v1/orders/create` | åˆ›å»ºç”Ÿäº§è®¢å• |
| GET | `/openapi/v1/orders/{orderNo}` | æŸ¥è¯¢è®¢å•çŠ¶æ€ |
| POST | `/openapi/v1/orders/list` | æŸ¥è¯¢è®¢å•åˆ—è¡¨ |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
# åˆ›å»ºè®¢å•
curl -X POST https://your-domain.com/openapi/v1/orders/create \
  -H "Content-Type: application/json" \
  -H "X-App-Key: os_xxxxxx" \
  -H "X-Timestamp: 1707638400000" \
  -H "X-Signature: a1b2c3d4..." \
  -d '{
    "externalOrderNo": "ERP-20260211-001",
    "styleNo": "FZ2024001",
    "styleName": "æ˜¥å­£è¡¬è¡«Aæ¬¾",
    "quantity": 500,
    "colors": ["çº¢", "è“", "ç™½"],
    "sizes": ["S", "M", "L", "XL"],
    "requiredDate": "2026-03-15",
    "factoryId": 1,
    "remark": "å®¢æˆ·ERPè‡ªåŠ¨æ¨é€"
  }'
```

### 4.2 è´¨æ£€åé¦ˆï¼ˆQUALITY_FEEDBACKï¼‰

**ç”¨é€”**ï¼šæˆ‘ä»¬çš„è´¨æ£€ç»“æœ â†’ æ¨é€åˆ°å®¢æˆ·ç³»ç»Ÿ

**æ•°æ®æµå‘**ï¼š
```
æˆ‘ä»¬çš„ç”Ÿäº§ç³»ç»Ÿ                      å®¢æˆ·ç³»ç»Ÿ
      â”‚                                â”‚
      â”‚  [å…¥åº“è´¨æ£€å®Œæˆ]                  â”‚
      â”‚  è‡ªåŠ¨è§¦å‘Webhookæ¨é€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
      â”‚  {è´¨æ£€ç»“æœã€ä¸è‰¯æ•°ã€ä¸è‰¯ç‡}       â”‚
      â”‚                                â”‚
      â”‚  æˆ–å®¢æˆ·ä¸»åŠ¨æŸ¥è¯¢:                 â”‚
      â”‚ â†â”€ GET /openapi/v1/quality/{no}â”‚
      â”‚  è¿”å›è´¨æ£€æŠ¥å‘Šè¯¦æƒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
```

**APIç«¯ç‚¹**ï¼š
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/openapi/v1/quality/{orderNo}` | æŸ¥è¯¢è´¨æ£€æŠ¥å‘Š |
| Webhook | è‡ªåŠ¨æ¨é€ | å…¥åº“è´¨æ£€å®Œæˆæ—¶è‡ªåŠ¨æ¨é€ |

### 4.3 ç‰©æµå¯¹æ¥ï¼ˆLOGISTICS_SYNCï¼‰

**ç”¨é€”**ï¼šæˆå“å‡ºåº“ â†’ è‡ªåŠ¨æ¨é€ç‰©æµä¿¡æ¯åˆ°å®¢æˆ·ç³»ç»Ÿ

**æ•°æ®æµå‘**ï¼š
```
æˆ‘ä»¬çš„ä»“åº“ç³»ç»Ÿ                      å®¢æˆ·ç³»ç»Ÿ
      â”‚                                â”‚
      â”‚  [æˆå“å‡ºåº“æ“ä½œ]                  â”‚
      â”‚  ProductOutstockOrchestrator    â”‚
      â”‚  è‡ªåŠ¨è§¦å‘Webhookæ¨é€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
      â”‚  {å‡ºåº“å•å·ã€ç‰©æµå…¬å¸ã€è¿å•å·}     â”‚
      â”‚                                â”‚
      â”‚  æˆ–å®¢æˆ·ä¸»åŠ¨æŸ¥è¯¢:                 â”‚
      â”‚ â†â”€ GET /openapi/v1/logistics/{no}â”‚
      â”‚  è¿”å›ç‰©æµè¯¦æƒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
```

**APIç«¯ç‚¹**ï¼š
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/openapi/v1/logistics/{orderNo}` | æŸ¥è¯¢ç‰©æµä¿¡æ¯ |
| Webhook | è‡ªåŠ¨æ¨é€ | æˆå“å‡ºåº“æ—¶è‡ªåŠ¨æ¨é€ |

### 4.4 ä»˜æ¬¾å¯¹æ¥ï¼ˆPAYMENT_SYNCï¼‰

**ç”¨é€”**ï¼šå¯¹è´¦ç»“ç®— â†” å®¢æˆ·æ”¯ä»˜ç³»ç»ŸåŒå‘åŒæ­¥

**æ•°æ®æµå‘**ï¼š
```
æˆ‘ä»¬çš„è´¢åŠ¡ç³»ç»Ÿ                      å®¢æˆ·æ”¯ä»˜ç³»ç»Ÿ
      â”‚                                â”‚
      â”‚  [å¯¹è´¦å•å®¡æ‰¹é€šè¿‡]               â”‚
      â”‚  ReconciliationStatusOrchestrator
      â”‚  è‡ªåŠ¨è§¦å‘Webhookæ¨é€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
      â”‚  {å¯¹è´¦å•å·ã€é‡‘é¢ã€å®¡æ‰¹çŠ¶æ€}      â”‚
      â”‚                                â”‚
      â”‚  å®¢æˆ·ç¡®è®¤ä»˜æ¬¾:                   â”‚
      â”‚ â†â”€ POST /openapi/v1/payment/confirm â”‚
      â”‚  æ›´æ–°å¯¹è´¦å•çŠ¶æ€ä¸º"å·²ä»˜æ¬¾"  â†â”€â”€â”€â”€â”€â”‚
      â”‚                                â”‚
      â”‚  å®¢æˆ·æŸ¥è¯¢å¯¹è´¦:                   â”‚
      â”‚ â†â”€ GET /openapi/v1/payment/{no}â”‚
      â”‚  è¿”å›å¯¹è´¦è¯¦æƒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚
```

**APIç«¯ç‚¹**ï¼š
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/openapi/v1/payment/confirm` | ç¡®è®¤ä»˜æ¬¾ |
| GET | `/openapi/v1/payment/{reconciliationNo}` | æŸ¥è¯¢å¯¹è´¦ä¿¡æ¯ |
| Webhook | è‡ªåŠ¨æ¨é€ | å¯¹è´¦å®¡æ‰¹é€šè¿‡æ—¶è‡ªåŠ¨æ¨é€ |

---

## 5. APIå¯¹æ¥å¼€å‘æŒ‡å—

### 5.1 è®¤è¯æœºåˆ¶ï¼ˆHMAC-SHA256ï¼‰

æ‰€æœ‰APIè¯·æ±‚å¿…é¡»æºå¸¦ä»¥ä¸‹3ä¸ªHeaderï¼š

| Header | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `X-App-Key` | åº”ç”¨å¯†é’¥ID | `os_a1b2c3d4e5f6` |
| `X-Timestamp` | è¯·æ±‚æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ | `1707638400000` |
| `X-Signature` | HMAC-SHA256ç­¾å | `a1b2c3d4...` |

**ç­¾åç®—æ³•**ï¼š

```
ç­¾ååŸæ–‡ = appKey + timestamp + requestBodyï¼ˆGETè¯·æ±‚bodyä¸ºç©ºå­—ç¬¦ä¸²ï¼‰
ç­¾åç»“æœ = HmacSHA256(ç­¾ååŸæ–‡, appSecret)
```

### 5.2 å„è¯­è¨€ç­¾åå®ç°

#### Java
```java
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.util.HexFormat;

public class OpenApiSigner {
    public static String sign(String appKey, String appSecret, 
                              long timestamp, String body) {
        String message = appKey + timestamp + (body != null ? body : "");
        try {
            Mac mac = Mac.getInstance("HmacSHA256");
            mac.init(new SecretKeySpec(appSecret.getBytes(), "HmacSHA256"));
            byte[] hash = mac.doFinal(message.getBytes());
            return HexFormat.of().formatHex(hash);
        } catch (Exception e) {
            throw new RuntimeException("ç­¾åå¤±è´¥", e);
        }
    }
}
```

#### Python
```python
import hmac, hashlib, time, requests, json

APP_KEY = "os_your_app_key"
APP_SECRET = "your_app_secret"
BASE_URL = "https://your-domain.com"

def call_api(method, path, body=None):
    timestamp = str(int(time.time() * 1000))
    body_str = json.dumps(body) if body else ""
    
    message = APP_KEY + timestamp + body_str
    signature = hmac.new(
        APP_SECRET.encode(), message.encode(), hashlib.sha256
    ).hexdigest()
    
    headers = {
        "Content-Type": "application/json",
        "X-App-Key": APP_KEY,
        "X-Timestamp": timestamp,
        "X-Signature": signature,
    }
    
    url = BASE_URL + path
    if method == "GET":
        return requests.get(url, headers=headers)
    else:
        return requests.post(url, headers=headers, json=body)

# ç¤ºä¾‹ï¼šåˆ›å»ºè®¢å•
resp = call_api("POST", "/openapi/v1/orders/create", {
    "externalOrderNo": "ERP-001",
    "styleNo": "FZ2024001",
    "quantity": 500,
    "colors": ["çº¢", "è“"],
    "sizes": ["S", "M", "L"]
})
print(resp.json())
```

#### JavaScript / Node.js
```javascript
const crypto = require('crypto');
const axios = require('axios');

const APP_KEY = 'os_your_app_key';
const APP_SECRET = 'your_app_secret';
const BASE_URL = 'https://your-domain.com';

async function callApi(method, path, body = null) {
  const timestamp = Date.now().toString();
  const bodyStr = body ? JSON.stringify(body) : '';
  const message = APP_KEY + timestamp + bodyStr;
  
  const signature = crypto
    .createHmac('sha256', APP_SECRET)
    .update(message)
    .digest('hex');
  
  const headers = {
    'Content-Type': 'application/json',
    'X-App-Key': APP_KEY,
    'X-Timestamp': timestamp,
    'X-Signature': signature,
  };
  
  const url = BASE_URL + path;
  if (method === 'GET') {
    return axios.get(url, { headers });
  }
  return axios.post(url, body, { headers });
}

// ç¤ºä¾‹ï¼šåˆ›å»ºè®¢å•
callApi('POST', '/openapi/v1/orders/create', {
  externalOrderNo: 'ERP-001',
  styleNo: 'FZ2024001',
  quantity: 500,
  colors: ['çº¢', 'è“'],
  sizes: ['S', 'M', 'L'],
}).then(res => console.log(res.data));
```

#### C# (.NET)
```csharp
using System.Security.Cryptography;
using System.Text;

public class OpenApiClient {
    private string _appKey;
    private string _appSecret;
    private string _baseUrl;
    private HttpClient _http = new HttpClient();
    
    public OpenApiClient(string appKey, string appSecret, string baseUrl) {
        _appKey = appKey;
        _appSecret = appSecret;
        _baseUrl = baseUrl;
    }
    
    public async Task<string> CallApiAsync(string method, string path, string body = "") {
        var timestamp = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds().ToString();
        var message = _appKey + timestamp + body;
        
        using var hmac = new HMACSHA256(Encoding.UTF8.GetBytes(_appSecret));
        var hash = hmac.ComputeHash(Encoding.UTF8.GetBytes(message));
        var signature = BitConverter.ToString(hash).Replace("-", "").ToLower();
        
        var request = new HttpRequestMessage(
            method == "GET" ? HttpMethod.Get : HttpMethod.Post,
            _baseUrl + path
        );
        request.Headers.Add("X-App-Key", _appKey);
        request.Headers.Add("X-Timestamp", timestamp);
        request.Headers.Add("X-Signature", signature);
        
        if (!string.IsNullOrEmpty(body))
            request.Content = new StringContent(body, Encoding.UTF8, "application/json");
        
        var response = await _http.SendAsync(request);
        return await response.Content.ReadAsStringAsync();
    }
}
```

### 5.3 APIå“åº”æ ¼å¼

**æˆåŠŸå“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": { ... },
  "requestId": "req_abc123"
}
```

**é”™è¯¯å“åº”**ï¼š
```json
{
  "code": 401,
  "message": "ç­¾åéªŒè¯å¤±è´¥",
  "data": null,
  "requestId": "req_abc124"
}
```

**é”™è¯¯ç è¡¨**ï¼š
| code | è¯´æ˜ |
|------|------|
| 200 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | è®¤è¯å¤±è´¥ï¼ˆappKeyæ— æ•ˆ/ç­¾åé”™è¯¯/æ—¶é—´æˆ³è¿‡æœŸï¼‰ |
| 403 | æƒé™ä¸è¶³ï¼ˆåº”ç”¨ç±»å‹ä¸åŒ¹é…/åº”ç”¨å·²è¿‡æœŸï¼‰ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 429 | è¶…å‡ºæ—¥è°ƒç”¨é™åˆ¶ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### 5.4 æ—¶é—´æˆ³æ ¡éªŒ

- æ—¶é—´æˆ³æœ‰æ•ˆæœŸï¼š**Â±5åˆ†é’Ÿ**
- æ ¼å¼ï¼š**Unixæ¯«ç§’æ—¶é—´æˆ³**
- è¶…è¿‡æœ‰æ•ˆæœŸçš„è¯·æ±‚ä¼šè¢«æ‹’ç»ï¼ˆè¿”å›401ï¼‰

---

## 6. æ•°æ®æ‹‰å–ï¼ˆPullï¼‰æœºåˆ¶

### 6.1 ä½¿ç”¨åœºæ™¯

å½“å®¢æˆ·ç³»ç»Ÿæœ‰æ•°æ®éœ€è¦å¯¼å…¥åˆ°æœ¬ç³»ç»Ÿæ—¶ï¼ˆå¦‚çº¸æ ·ã€åˆ¶å•æ•°æ®ï¼‰ï¼Œä½¿ç”¨Pullæœºåˆ¶ï¼š

```
å®¢æˆ·çº¸æ ·/åˆ¶å•ç³»ç»Ÿ                æœ¬ç³»ç»ŸOpenAPI
       â”‚                            â”‚
       â”‚    (å®¢æˆ·ç³»ç»Ÿæä¾›ä¸€ä¸ªAPI)      â”‚
       â”‚                            â”‚
       â”‚ â†â”€â”€ æœ¬ç³»ç»Ÿä¸»åŠ¨è°ƒå®¢æˆ·API â”€â”€â”€â”€â”‚  POST /openapi/v1/pull/pattern-order
       â”‚                            â”‚  { action: "list_patterns", params: {...} }
       â”‚    è¿”å›çº¸æ ·/åˆ¶å•æ•°æ® â”€â”€â”€â”€â”€â”€â†’ â”‚
       â”‚                            â”‚  è½¬å‘åˆ°å®¢æˆ·çš„ externalApiUrl
       â”‚                            â”‚
       â”‚    æˆ–ç›´æ¥å¯¼å…¥è®¢å•:           â”‚
       â”‚ â†â”€â”€ action: "import_order" â”‚  ç›´æ¥åœ¨æœ¬ç³»ç»Ÿåˆ›å»ºç”Ÿäº§è®¢å•
```

### 6.2 Pullç«¯ç‚¹

**POST** `/openapi/v1/pull/pattern-order`

#### æ¨¡å¼ä¸€ï¼šè½¬å‘æŸ¥è¯¢ï¼ˆlist_patterns / list_orders / get_pattern / get_orderï¼‰

å°†è¯·æ±‚è½¬å‘åˆ°å®¢æˆ·çš„ `externalApiUrl`ï¼Œè·å–çº¸æ ·/åˆ¶å•åˆ—è¡¨ã€‚

**å‰ææ¡ä»¶**ï¼šTenantApp å¿…é¡»é…ç½®äº† `externalApiUrl`ï¼ˆåœ¨ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€ä¸­è®¾ç½®ï¼‰ã€‚

```bash
# æŸ¥è¯¢å®¢æˆ·ç³»ç»Ÿçš„çº¸æ ·åˆ—è¡¨
curl -X POST /openapi/v1/pull/pattern-order \
  -H "X-App-Key: os_xxx" \
  -H "X-Timestamp: 1707638400000" \
  -H "X-Signature: abc123..." \
  -d '{
    "action": "list_patterns",
    "params": {
      "status": "ready",
      "page": 1,
      "size": 20
    }
  }'

# å“åº”ï¼š
{
  "code": 200,
  "data": {
    "action": "list_patterns",
    "source": "https://customer-erp.com/api",
    "httpStatus": 200,
    "success": true,
    "data": [
      { "patternId": "P001", "styleName": "æ˜¥å­£è¡¬è¡«", "status": "ready" },
      { "patternId": "P002", "styleName": "å¤å­£Tæ¤", "status": "ready" }
    ]
  }
}
```

#### æ¨¡å¼äºŒï¼šç›´æ¥å¯¼å…¥è®¢å•ï¼ˆimport_orderï¼‰

è·³è¿‡è½¬å‘ï¼Œç›´æ¥åœ¨æœ¬ç³»ç»Ÿåˆ›å»ºç”Ÿäº§è®¢å•ã€‚

```bash
curl -X POST /openapi/v1/pull/pattern-order \
  -H "X-App-Key: os_xxx" \
  -H "X-Timestamp: 1707638400000" \
  -H "X-Signature: abc123..." \
  -d '{
    "action": "import_order",
    "externalOrderNo": "PAPER-2026-001",
    "styleNo": "FZ2024001",
    "styleName": "æ˜¥å­£è¡¬è¡«",
    "quantity": 500,
    "colors": ["çº¢", "è“"],
    "sizes": ["S", "M", "L"],
    "factoryId": 1,
    "remark": "ä»çº¸æ ·ç³»ç»Ÿå¯¼å…¥"
  }'
```

### 6.3 å®¢æˆ·ç³»ç»ŸAPIè¦æ±‚

å¦‚æœä½¿ç”¨è½¬å‘æ¨¡å¼ï¼Œå®¢æˆ·ç³»ç»Ÿéœ€æä¾›ä¸€ä¸ªHTTP APIï¼Œæ¥å—ä»¥ä¸‹è¯·æ±‚ï¼š

- **URL**ï¼šé…ç½®åœ¨ TenantApp çš„ `externalApiUrl` å­—æ®µ
- **æ–¹æ³•**ï¼šPOST
- **è¯·æ±‚å¤´**ï¼š
  - `Content-Type: application/json`
  - `X-Source: fashion-supplychain`
  - `X-App-Key: {appKey}`
- **è¯·æ±‚ä½“**ï¼šPullè¯·æ±‚ä¸­çš„ `params` å¯¹è±¡
- **å“åº”**ï¼šJSONæ ¼å¼ï¼Œä»»æ„ç»“æ„

### 6.4 é…ç½®å®¢æˆ·APIåœ°å€

1. è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€é¡µé¢
2. æ‰¾åˆ°å¯¹åº”çš„TenantAppï¼ˆå¦‚"ä¸‹å•å¯¹æ¥(è¯•ç”¨)"ï¼‰
3. ç¼–è¾‘åº”ç”¨ï¼Œå¡«å†™ã€Œå®¢æˆ·ç³»ç»ŸAPIåœ°å€ã€å­—æ®µ
4. ä¿å­˜åå³å¯ä½¿ç”¨PullåŠŸèƒ½

---

## 7. Webhookæ¨é€ï¼ˆPushï¼‰æœºåˆ¶

### 7.1 æ¨é€æ—¶æœº

| ä¸šåŠ¡äº‹ä»¶ | æ¨é€ç±»å‹ | è§¦å‘ä½ç½® |
|---------|---------|---------|
| æˆå“å‡ºåº“ | `LOGISTICS_UPDATE` | ProductOutstockOrchestrator.save() |
| ç”Ÿäº§è®¢å•å®Œæˆ | `ORDER_STATUS` | ProductionOrderFinanceOrchestrationService.completeProduction() |
| å¯¹è´¦å•å®¡æ‰¹é€šè¿‡ | `RECONCILIATION_CREATED` | ReconciliationStatusOrchestrator.updateStatus() |
| å…¥åº“è´¨æ£€å®Œæˆ | `QUALITY_RESULT` | ï¼ˆå¯æŒ‰éœ€é…ç½®ï¼‰ |

### 7.2 Webhookæ•°æ®æ ¼å¼

```json
{
  "event": "ORDER_STATUS",
  "timestamp": "2026-02-11T14:30:00",
  "data": {
    "orderNo": "PO20260211001",
    "status": "completed",
    "message": "ç”Ÿäº§è®¢å•å·²å®Œæˆ"
  }
}
```

### 7.3 Webhookç­¾åéªŒè¯

æ¨é€è¯·æ±‚åŒ…å«ç­¾åå¤´ï¼Œå®¢æˆ·ç³»ç»Ÿåº”éªŒè¯ï¼š

| Header | è¯´æ˜ |
|--------|------|
| `X-Webhook-Signature` | HMAC-SHA256ç­¾åï¼ˆä½¿ç”¨ callbackSecretï¼‰ |
| `X-Webhook-Timestamp` | æ¨é€æ—¶é—´æˆ³ |

**éªŒè¯æ–¹å¼**ï¼š
```python
# å®¢æˆ·ä¾§éªŒè¯Webhookç­¾å
import hmac, hashlib

def verify_webhook(callback_secret, timestamp, body, received_signature):
    message = timestamp + body  # æ—¶é—´æˆ³ + è¯·æ±‚ä½“
    expected = hmac.new(
        callback_secret.encode(), message.encode(), hashlib.sha256
    ).hexdigest()
    return hmac.compare_digest(expected, received_signature)
```

### 7.4 é…ç½®Webhookå›è°ƒ

1. è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€é¡µé¢
2. æ‰¾åˆ°å¯¹åº”çš„TenantApp
3. ç¼–è¾‘åº”ç”¨ï¼Œå¡«å†™ä»¥ä¸‹å­—æ®µï¼š
   - **å›è°ƒURL**ï¼šå¦‚ `https://your-erp.com/webhook/fashion`
   - **å›è°ƒç­¾åå¯†é’¥**ï¼šè‡ªåŠ¨ç”Ÿæˆï¼Œç”¨äºéªŒç­¾
4. ä¿å­˜åè‡ªåŠ¨å¯ç”¨æ¨é€

---

## 8. å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»è¯´æ˜

### 8.1 éš”ç¦»æœºåˆ¶

ç³»ç»Ÿé‡‡ç”¨**åŒé‡è¿‡æ»¤**ç¡®ä¿ç§Ÿæˆ·æ•°æ®éš”ç¦»ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®éš”ç¦»å±‚                          â”‚
â”‚                                              â”‚
â”‚  ç¬¬ä¸€å±‚ï¼štenantId è¿‡æ»¤                        â”‚
â”‚  Â· AppStoreè´­ä¹°/è®¢é˜… â†’ æŒ‰ tenantId éš”ç¦»      â”‚
â”‚  Â· TenantAppå‡­è¯ â†’ æŒ‰ tenantId éš”ç¦»          â”‚
â”‚  Â· è®¢é˜…è®°å½• â†’ æŒ‰ tenantId éš”ç¦»               â”‚
â”‚                                              â”‚
â”‚  ç¬¬äºŒå±‚ï¼šcreatedByName æ ‡è®°è¿‡æ»¤               â”‚
â”‚  Â· APIåˆ›å»ºçš„è®¢å• â†’ createdByName="OpenAPI-xxx"â”‚
â”‚  Â· æŸ¥è¯¢è®¢å• â†’ åªè¿”å› likeRight("OpenAPI-") çš„ â”‚
â”‚  Â· æŸ¥è´¨æ£€/ç‰©æµ â†’ å…ˆéªŒè¯è®¢å•å½’å±å†è¿”å›         â”‚
â”‚                                              â”‚
â”‚  ç¬¬ä¸‰å±‚ï¼šappKey é‰´æƒ                          â”‚
â”‚  Â· æ¯ä¸ªè¯·æ±‚å…ˆéªŒè¯ appKey â†’ è·å– TenantApp     â”‚
â”‚  Â· TenantApp.tenantId â†’ å½“å‰ç§Ÿæˆ·              â”‚
â”‚  Â· åªèƒ½æ“ä½œè‡ªå·±ç§Ÿæˆ·çš„æ•°æ®                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ç§Ÿæˆ·Aä¸èƒ½çœ‹åˆ°ç§Ÿæˆ·Bçš„æ•°æ®

| åœºæ™¯ | éš”ç¦»æ–¹å¼ |
|------|---------|
| ç§Ÿæˆ·AæŸ¥è®¢å• | listExternalOrders åªè¿”å› createdByName LIKE 'OpenAPI-%' çš„è®¢å• |
| ç§Ÿæˆ·AæŸ¥è´¨æ£€æŠ¥å‘Š | getQualityReport å…ˆéªŒè¯è®¢å•æ˜¯OpenAPIåˆ›å»ºçš„æ‰è¿”å› |
| ç§Ÿæˆ·AæŸ¥ç‰©æµ | getLogisticsStatus å…ˆéªŒè¯è®¢å•å½’å± |
| ç§Ÿæˆ·AæŸ¥å¯¹è´¦ | getPaymentStatus æŒ‰å¯¹è´¦å•å·+ç§Ÿæˆ·è¿‡æ»¤ |
| ç§Ÿæˆ·Aè´­ä¹°åº”ç”¨ | AppStoreæŒ‰tenantIdéš”ç¦»è®¢é˜…å’Œè¯•ç”¨è®°å½• |
| ç§Ÿæˆ·Açš„APIå¯†é’¥ | TenantAppæŒ‰tenantIdéš”ç¦»,åªèƒ½æŸ¥è‡ªå·±çš„åº”ç”¨ |

### 8.3 å®‰å…¨ä¿éšœ

- âœ… **appKeyå”¯ä¸€ç»‘å®š**ï¼šä¸€ä¸ªappKeyåªå±äºä¸€ä¸ªç§Ÿæˆ·
- âœ… **ç­¾åé˜²ç¯¡æ”¹**ï¼šHMAC-SHA256ç¡®ä¿è¯·æ±‚æœªè¢«ç¯¡æ”¹
- âœ… **æ—¶é—´æˆ³é˜²é‡æ”¾**ï¼š5åˆ†é’Ÿçª—å£æœŸé˜²æ­¢è¯·æ±‚é‡æ”¾æ”»å‡»
- âœ… **æ—¥é…é¢é™åˆ¶**ï¼šé˜²æ­¢æ»¥ç”¨ï¼ˆè¯•ç”¨100æ¬¡/æ—¥ï¼Œæ­£å¼å¯é…ç½®ï¼‰
- âœ… **è¿‡æœŸæœºåˆ¶**ï¼šè¯•ç”¨åˆ°æœŸè‡ªåŠ¨åœç”¨ï¼Œå¯†é’¥å¤±æ•ˆ

---

## 9. å®Œæ•´å¯¹æ¥æµç¨‹å›¾

### 9.1 è´­ä¹°â†’å¯¹æ¥â†’ä½¿ç”¨å…¨æµç¨‹

```
[æ­¥éª¤1] ç®¡ç†å‘˜ç™»å½•åå°
    â”‚
    â–¼
[æ­¥éª¤2] è¿›å…¥ã€Œåº”ç”¨å•†åº—ã€ï¼ˆèœå•è·¯å¾„: ç³»ç»Ÿç®¡ç† â†’ ğŸ›’ åº”ç”¨å•†åº—ï¼‰
    â”‚         é¡µé¢ URL: /system/app-store
    â–¼
[æ­¥éª¤3] é€‰æ‹©éœ€è¦çš„å¯¹æ¥æ¨¡å—ï¼ˆå¦‚"ä¸‹å•å¯¹æ¥"ï¼‰
    â”‚
    â”œâ”€â”€â†’ [è¯•ç”¨] ç‚¹å‡»"å…è´¹è¯•ç”¨7å¤©"
    â”‚         â†“
    â”‚    ç³»ç»Ÿè‡ªåŠ¨ï¼š
    â”‚    â‘  åˆ›å»º TenantSubscription è®¢é˜…è®°å½•
    â”‚    â‘¡ åˆ›å»º TenantApp (appKey + appSecret)
    â”‚    â‘¢ å¼¹çª—æ˜¾ç¤ºå¯†é’¥ âš ï¸ è¯·ä¿å­˜ï¼
    â”‚
    â””â”€â”€â†’ [è´­ä¹°] å¡«å†™è”ç³»ä¿¡æ¯ â†’ åˆ›å»ºè®¢å• â†’ ä»˜æ¬¾åæ¿€æ´»
    
    â–¼
[æ­¥éª¤4] å®¢æˆ·å¼€å‘è€…æ‹¿åˆ° appKey + appSecret
    â”‚
    â–¼
[æ­¥éª¤5] æŒ‰ç­¾åç®—æ³•å®ç°APIè°ƒç”¨ï¼ˆå‚è€ƒç¬¬5ç« ä»£ç ç¤ºä¾‹ï¼‰
    â”‚
    â”œâ”€â”€â†’ [æ¨é€è®¢å•] POST /openapi/v1/orders/create
    â”œâ”€â”€â†’ [æŸ¥è¯¢è®¢å•] GET /openapi/v1/orders/{no}
    â”œâ”€â”€â†’ [æŸ¥è´¨æ£€]  GET /openapi/v1/quality/{no}
    â”œâ”€â”€â†’ [æŸ¥ç‰©æµ]  GET /openapi/v1/logistics/{no}
    â”œâ”€â”€â†’ [æ‹‰çº¸æ ·]  POST /openapi/v1/pull/pattern-order
    â””â”€â”€â†’ [ç¡®è®¤ä»˜æ¬¾] POST /openapi/v1/payment/confirm
    
    â–¼
[æ­¥éª¤6] é…ç½®Webhookæ¥æ”¶æ¨é€ï¼ˆå¯é€‰ï¼‰
    â”‚    è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ ç¼–è¾‘åº”ç”¨ â†’ å¡«å›è°ƒURL
    â”‚
    â””â”€â”€â†’ ç³»ç»Ÿåœ¨å‡ºåº“/å®Œå·¥/å®¡æ‰¹æ—¶è‡ªåŠ¨æ¨é€åˆ°å®¢æˆ·ç³»ç»Ÿ

    â–¼
[æ­¥éª¤7] åœ¨ç®¡ç†åå°æŸ¥çœ‹é›†æˆçŠ¶æ€
         è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ã€Œé›†æˆæ€»è§ˆã€Tab
         æŸ¥çœ‹4ä¸ªæ¨¡å—çš„è¿æ¥çŠ¶æ€ã€è°ƒç”¨ç»Ÿè®¡ã€æœ€è¿‘æ—¥å¿—
```

### 9.2 æ•°æ®æµå®Œæ•´å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        å®¢æˆ·ç³»ç»Ÿï¼ˆç¬¬ä¸‰æ–¹ï¼‰         â”‚
                    â”‚  Â· ERP Â· çº¸æ ·ç³»ç»Ÿ Â· æ”¯ä»˜ç³»ç»Ÿ     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚          â”‚
              Pushè®¢å•     â”‚          â”‚  Webhookå›è°ƒ
              Pullçº¸æ ·     â”‚          â”‚  (å‡ºåº“/å®Œå·¥/å®¡æ‰¹)
                           â”‚          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    OpenAPI ç½‘å…³ (/openapi/v1/*)   â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                    â”‚  â”‚ é‰´æƒå±‚:                    â”‚    â”‚
                    â”‚  â”‚ X-App-Key â†’ TenantAppæŸ¥è¯¢  â”‚    â”‚
                    â”‚  â”‚ X-Signature â†’ HMACéªŒç­¾     â”‚    â”‚
                    â”‚  â”‚ X-Timestamp â†’ æ—¶é—´çª—å£æ ¡éªŒ  â”‚    â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                    â”‚              â”‚                    â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                    â”‚  â”‚ æ•°æ®éš”ç¦»å±‚:                â”‚    â”‚
                    â”‚  â”‚ tenantId è¿‡æ»¤             â”‚    â”‚
                    â”‚  â”‚ createdByName æ ‡è®°è¿‡æ»¤    â”‚    â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚       ä¸šåŠ¡ç¼–æ’å±‚ (Orchestrator)      â”‚
                    â”‚                                     â”‚
                    â”‚  OpenApiOrchestrator                 â”‚
                    â”‚  â”œâ”€ createExternalOrder() â†’ åˆ›å»ºè®¢å• â”‚
                    â”‚  â”œâ”€ getOrderStatus() â†’ æŸ¥è¯¢çŠ¶æ€      â”‚
                    â”‚  â”œâ”€ getQualityReport() â†’ è´¨æ£€æŠ¥å‘Š    â”‚
                    â”‚  â”œâ”€ getLogisticsStatus() â†’ ç‰©æµä¿¡æ¯  â”‚
                    â”‚  â”œâ”€ confirmPayment() â†’ ç¡®è®¤ä»˜æ¬¾      â”‚
                    â”‚  â””â”€ pullExternalData() â†’ æ‹‰å–çº¸æ ·    â”‚
                    â”‚                                     â”‚
                    â”‚  WebhookPushService                  â”‚
                    â”‚  â”œâ”€ pushOrderStatusChange()          â”‚
                    â”‚  â”œâ”€ pushQualityResult()              â”‚
                    â”‚  â”œâ”€ pushLogisticsUpdate()            â”‚
                    â”‚  â””â”€ pushReconciliationCreated()      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           æ•°æ®åº“                    â”‚
                    â”‚  t_production_order   (ç”Ÿäº§è®¢å•)    â”‚
                    â”‚  t_tenant_app         (APIå‡­è¯)    â”‚
                    â”‚  t_tenant_app_log     (è°ƒç”¨æ—¥å¿—)    â”‚
                    â”‚  t_tenant_subscription (è®¢é˜…è®°å½•)   â”‚
                    â”‚  t_app_store          (åº”ç”¨å•†å“)    â”‚
                    â”‚  t_app_order          (è´­ä¹°è®¢å•)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. å¸¸è§é—®é¢˜FAQ

### Q1: è¯•ç”¨æœŸç»“æŸåæ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ
**ä¸ä¼š**ã€‚è¯•ç”¨æœŸç»“æŸåAPIå‡­è¯ä¼šè¿‡æœŸæ— æ³•è°ƒç”¨ï¼Œä½†å·²åˆ›å»ºçš„è®¢å•ã€è´¨æ£€è®°å½•ç­‰æ•°æ®**æ°¸ä¹…ä¿ç•™**ã€‚å‡çº§ä¸ºæ­£å¼è®¢é˜…åå¯ç»§ç»­ä½¿ç”¨ã€‚

### Q2: ä¸€ä¸ªç§Ÿæˆ·å¯ä»¥åˆ›å»ºå¤šä¸ªåŒç±»å‹åº”ç”¨å—ï¼Ÿ
**å¯ä»¥**ã€‚æ¯”å¦‚ä¸€ä¸ªå¤§å®¢æˆ·æœ‰å¤šä¸ªERPç³»ç»Ÿï¼Œå¯ä»¥ä¸ºæ¯ä¸ªç³»ç»Ÿåˆ›å»ºç‹¬ç«‹çš„ ORDER_SYNC åº”ç”¨ï¼Œå„è‡ªæœ‰ç‹¬ç«‹çš„ appKey/appSecretã€‚

### Q3: appSecretä¸¢å¤±åæ€ä¹ˆåŠï¼Ÿ
è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ æ‰¾åˆ°å¯¹åº”åº”ç”¨ â†’ ç‚¹å‡»ã€Œé‡ç½®å¯†é’¥ã€ã€‚ç³»ç»Ÿä¼šç”Ÿæˆæ–°çš„ appSecretï¼Œæ—§å¯†é’¥ç«‹å³å¤±æ•ˆã€‚

### Q4: å¦‚ä½•æŸ¥çœ‹APIè°ƒç”¨æ—¥å¿—ï¼Ÿ
è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ã€ŒAPIæ—¥å¿—ã€Tabï¼Œå¯æŒ‰åº”ç”¨ã€æ—¶é—´ã€çŠ¶æ€è¿‡æ»¤æŸ¥çœ‹æ¯æ¬¡APIè°ƒç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚

### Q5: Webhookæ¨é€å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
ç³»ç»Ÿä¼šè®°å½•æ¨é€æ—¥å¿—ã€‚å¦‚æœå›è°ƒURLä¸å¯è¾¾ï¼Œæ¨é€ä¼šé™é»˜å¤±è´¥ä¸å½±å“ä¸»ä¸šåŠ¡ã€‚å»ºè®®å®¢æˆ·ç³»ç»Ÿç¡®ä¿Webhook URLé«˜å¯ç”¨ã€‚

### Q6: Pullæ‹‰å–æ•°æ®æ—¶æŠ¥"æœªé…ç½®å®¢æˆ·APIåœ°å€"ï¼Ÿ
è¿›å…¥ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ ç¼–è¾‘å¯¹åº”åº”ç”¨ â†’ åœ¨ã€Œå®¢æˆ·ç³»ç»ŸAPIåœ°å€ã€å­—æ®µå¡«å…¥å®¢æˆ·ç³»ç»Ÿçš„APIæ¥å£åœ°å€ã€‚

### Q7: APIè¯·æ±‚è¿”å›401ç­¾åéªŒè¯å¤±è´¥ï¼Ÿ
1. æ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦åœ¨Â±5åˆ†é’Ÿå†…ï¼ˆæ¯«ç§’çº§ï¼‰
2. æ£€æŸ¥ç­¾ååŸæ–‡æ‹¼æ¥æ˜¯å¦æ­£ç¡®ï¼š`appKey + timestamp + body`
3. æ£€æŸ¥AppSecretæ˜¯å¦æ­£ç¡®ï¼ˆåˆ›å»ºæ—¶ä»…æ˜¾ç¤ºä¸€æ¬¡ï¼‰
4. æ£€æŸ¥bodyæ˜¯å¦æ˜¯JSONåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼ˆä¸æ˜¯pretty printï¼‰

### Q8: å¦‚ä½•ä»çº¸æ ·ç³»ç»Ÿæ‹‰å–æ•°æ®åˆ›å»ºè®¢å•ï¼Ÿ
ä¸¤ç§æ–¹å¼ï¼š
1. **è½¬å‘æŸ¥è¯¢**ï¼šé€šè¿‡ `action: "list_patterns"` å…ˆæŸ¥è¯¢çº¸æ ·åˆ—è¡¨ï¼Œå‰ç«¯å±•ç¤ºåç”¨æˆ·é€‰æ‹©å¯¼å…¥
2. **ç›´æ¥å¯¼å…¥**ï¼šé€šè¿‡ `action: "import_order"` ç›´æ¥æ ¹æ®çº¸æ ·ä¿¡æ¯åœ¨æœ¬ç³»ç»Ÿåˆ›å»ºç”Ÿäº§è®¢å•

### Q9: ä¸åŒç§Ÿæˆ·çš„API Base URLæ˜¯ä¸€æ ·çš„å—ï¼Ÿ
**æ˜¯çš„**ã€‚æ‰€æœ‰ç§Ÿæˆ·å…±äº«åŒä¸€ä¸ªAPIç½‘å…³åœ°å€ï¼Œé€šè¿‡ä¸åŒçš„ appKey åŒºåˆ†ç§Ÿæˆ·èº«ä»½ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨æŒ‰tenantIdè¿›è¡Œæ•°æ®éš”ç¦»ã€‚

### Q10: é…é¢ç”¨å®Œäº†æ€ä¹ˆåŠï¼Ÿ
æ—¥é…é¢æ¯å¤©UTC 00:00è‡ªåŠ¨é‡ç½®ã€‚å¦‚éœ€è°ƒé«˜é…é¢ï¼Œè¯·åœ¨ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€ä¸­ä¿®æ”¹åº”ç”¨çš„ã€Œæ—¥è°ƒç”¨ä¸Šé™ã€è®¾ç½®ã€‚

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **ç³»ç»Ÿç®¡ç†å‘˜**ï¼šåœ¨ã€Œå®¢æˆ·åº”ç”¨ç®¡ç†ã€â†’ã€Œé›†æˆæ€»è§ˆã€æŸ¥çœ‹å„æ¨¡å—è¿æ¥çŠ¶æ€
- **å¼€å‘è€…å¯¹æ¥**ï¼šæŒ‰æœ¬æ–‡æ¡£ç¬¬5ç« å®ç°ç­¾åå’ŒAPIè°ƒç”¨
- **é—®é¢˜æ’æŸ¥**ï¼šæŸ¥çœ‹ã€ŒAPIæ—¥å¿—ã€Tabå®šä½å…·ä½“çš„è¯·æ±‚å’Œå“åº”
- **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0 (2026-02-11)

---

> ğŸ’¡ **å¿«é€Ÿä¸Šæ‰‹å»ºè®®**ï¼šå…ˆç”¨ã€Œå…è´¹è¯•ç”¨7å¤©ã€ä½“éªŒï¼Œä¿å­˜å¥½å¯†é’¥åæŒ‰ç…§ç¬¬5ç« çš„ä»£ç ç¤ºä¾‹è¿›è¡Œå¯¹æ¥ã€‚
