# ğŸ“± SaaS åº”ç”¨å•†åº—ç³»ç»Ÿ - å®Œæ•´å®ç°æŒ‡å—

> **å®ç°æ—¥æœŸ**ï¼š2026-02-10  
> **åŠŸèƒ½æ¦‚è¿°**ï¼šåº”ç”¨å•†åº— + è®¢é˜…è´­ä¹° + æ”¯ä»˜æµç¨‹  
> **çŠ¶æ€**ï¼šâœ… æ•°æ®åº“å·²å»ºè¡¨ï¼Œâœ… åç«¯ä»£ç å·²å®Œæˆï¼Œâœ… å‰ç«¯é¡µé¢å·²å®Œæˆ

---

## ğŸ¯ åŠŸèƒ½æ€»è§ˆ

### æ ¸å¿ƒåŠŸèƒ½æµç¨‹
```
[åº”ç”¨å•†åº—é¦–é¡µ] 
    â†“ ç‚¹å‡»åº”ç”¨å›¾æ ‡
[åº”ç”¨è¯¦æƒ…å¼¹çª—] 
    â†“ ç‚¹å‡»è´­ä¹°æŒ‰é’®
[å¡«å†™è´­ä¹°ä¿¡æ¯] 
    â†“ æäº¤è®¢å•
[æ”¯ä»˜é¡µé¢] 
    â†“ æ”¯ä»˜æˆåŠŸ
[å¼€é€šåº”ç”¨è®¢é˜…]
```

### å·²å®Œæˆçš„æ¨¡å—
- âœ… **æ•°æ®åº“è¡¨ç»“æ„**ï¼ˆ4å¼ è¡¨ï¼‰
  - `t_app_store` - åº”ç”¨å•†åº—ï¼ˆå¯è´­ä¹°çš„åº”ç”¨åˆ—è¡¨ï¼‰
  - `t_tenant_subscription` - ç§Ÿæˆ·è®¢é˜…ï¼ˆå·²è´­ä¹°çš„åº”ç”¨ï¼‰
  - `t_app_order` - åº”ç”¨è®¢å•ï¼ˆè´­ä¹°è®¢å•è®°å½•ï¼‰
  - `t_app_payment` - æ”¯ä»˜è®°å½•ï¼ˆæ”¯ä»˜æµæ°´ï¼‰

- âœ… **åç«¯ API**
  - `POST /api/system/app-store/list` - è·å–åº”ç”¨åˆ—è¡¨
  - `GET /api/system/app-store/{id}` - è·å–åº”ç”¨è¯¦æƒ…
  - `POST /api/system/app-store/create-order` - åˆ›å»ºè®¢å•
  - `POST /api/system/app-store/my-subscriptions` - æˆ‘çš„è®¢é˜…

- âœ… **å‰ç«¯é¡µé¢**
  - åº”ç”¨å•†åº—é¦–é¡µ - å¡ç‰‡ç½‘æ ¼å¸ƒå±€ + Badge æ ‡ç­¾ï¼ˆçƒ­é—¨/æ–°åº”ç”¨ï¼‰
  - åº”ç”¨è¯¦æƒ…å¼¹çª— - åŠŸèƒ½åˆ—è¡¨ + ä»·æ ¼æ–¹æ¡ˆ
  - è´­ä¹°è®¢å•å¼¹çª— - è¡¨å•å¡«å†™ + å‘ç¥¨ä¿¡æ¯

---

## ğŸ—ƒï¸ æ•°æ®åº“è¡¨ç»“æ„

### 1. t_app_storeï¼ˆåº”ç”¨å•†åº—ï¼‰
å­˜å‚¨å¯è´­ä¹°çš„åº”ç”¨ï¼Œå·²åˆå§‹åŒ– 4 ä¸ªåº”ç”¨ï¼š

| app_code | app_name | price_monthly | is_hot | åŠŸèƒ½ |
|----------|----------|---------------|--------|------|
| ORDER_SYNC | ä¸‹å•å¯¹æ¥ | Â¥699/æœˆ | ğŸ”¥ çƒ­é—¨ | è®¢å•åŒæ­¥ã€è‡ªåŠ¨ä¸‹å•ã€è¿›åº¦è·Ÿè¸ªã€å¼‚å¸¸é¢„è­¦ |
| QUALITY_FEEDBACK | è´¨æ£€åé¦ˆ | Â¥499/æœˆ | - | è´¨æ£€æŠ¥å‘Šã€å®æ—¶åé¦ˆã€ä¸è‰¯å“è¿½è¸ªã€æ•°æ®ç»Ÿè®¡ |
| LOGISTICS_SYNC | ç‰©æµå¯¹æ¥ | Â¥599/æœˆ | ğŸ”¥ çƒ­é—¨ | ç‰©æµè·Ÿè¸ªã€è‡ªåŠ¨ç­¾æ”¶ã€è¿è´¹è®¡ç®—ã€è½¨è¿¹æŸ¥è¯¢ |
| PAYMENT_SYNC | ä»˜æ¬¾å¯¹æ¥ | Â¥799/æœˆ | - | å¯¹è´¦å•åŒæ­¥ã€è‡ªåŠ¨æ ¸é”€ã€ä»˜æ¬¾ç”³è¯·ã€è´¢åŠ¡æŠ¥è¡¨ |

**ä»·æ ¼æ–¹æ¡ˆ**ï¼š
- æœˆä»˜ï¼šæŒ‰æœˆè®¢é˜…
- å¹´ä»˜ï¼šæŒ‰å¹´è®¢é˜…ï¼ˆé€šå¸¸æœ‰ä¼˜æƒ ï¼‰
- ä¹°æ–­ï¼šä¸€æ¬¡æ€§è´­ä¹°æ°¸ä¹…ä½¿ç”¨
- è¯•ç”¨ï¼šå…è´¹è¯•ç”¨ 7 å¤©

---

## ğŸ¨ å‰ç«¯é¡µé¢å±•ç¤ºæ•ˆæœ

### åº”ç”¨å•†åº—é¦–é¡µï¼ˆå¡ç‰‡å¸ƒå±€ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [çƒ­é—¨]  â”‚          â”‚  [çƒ­é—¨]  â”‚          â”‚
â”‚    ğŸ“‹    â”‚    âœ…    â”‚    ğŸšš    â”‚    ğŸ’³    â”‚
â”‚  ä¸‹å•å¯¹æ¥ â”‚  è´¨æ£€åé¦ˆ â”‚  ç‰©æµå¯¹æ¥ â”‚  ä»˜æ¬¾å¯¹æ¥ â”‚
â”‚  Â¥699/æœˆ â”‚  Â¥499/æœˆ â”‚  Â¥599/æœˆ â”‚  Â¥799/æœˆ â”‚
â”‚ ä¾›åº”é“¾å¯¹æ¥â”‚ ä¾›åº”é“¾å¯¹æ¥â”‚ ä¾›åº”é“¾å¯¹æ¥â”‚ ä¾›åº”é“¾å¯¹æ¥â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾è®¡ç‰¹ç‚¹**ï¼š
- âœ… å¡ç‰‡æ‚¬æµ®åŠ¨ç”»ï¼ˆhover ä¸Šç§» 8pxï¼‰
- âœ… æ¸å˜èƒŒæ™¯å›¾æ ‡åŒºåŸŸ
- âœ… Badge æ ‡ç­¾ï¼ˆçº¢è‰²=çƒ­é—¨ï¼Œè“è‰²=æ–°åº”ç”¨ï¼‰
- âœ… å“åº”å¼å¸ƒå±€ï¼ˆxs/sm/md/lg/xlï¼‰

---

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### 1. è®¿é—®åº”ç”¨å•†åº—
åœ¨ç³»ç»Ÿèœå•ä¸­æ·»åŠ åº”ç”¨å•†åº—å…¥å£ï¼ˆéœ€è¦é…ç½®è·¯ç”±ï¼‰ï¼š

```typescript
// frontend/src/routeConfig.ts
{
  path: '/system/app-store',
  component: () => import('@/modules/system/pages/AppStore'),
  meta: { title: 'åº”ç”¨å•†åº—', requiresAuth: true }
}
```

### 2. æµè§ˆåº”ç”¨
```
1. è¿›å…¥åº”ç”¨å•†åº—é¡µé¢
2. æµè§ˆæ‰€æœ‰å¯è´­ä¹°çš„åº”ç”¨å¡ç‰‡
3. æŸ¥çœ‹åº”ç”¨å›¾æ ‡ã€åç§°ã€ä»·æ ¼ã€åˆ†ç±»
4. ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
```

### 3. æŸ¥çœ‹åº”ç”¨è¯¦æƒ…
ç‚¹å‡»åº”ç”¨å¡ç‰‡åå¼¹å‡ºè¯¦æƒ…çª—å£ï¼Œæ˜¾ç¤ºï¼š
- åº”ç”¨ç®€ä»‹
- æ ¸å¿ƒåŠŸèƒ½åˆ—è¡¨ï¼ˆå¸¦ç»¿è‰²âœ“å›¾æ ‡ï¼‰
- ä»·æ ¼æ–¹æ¡ˆï¼ˆæœˆä»˜/å¹´ä»˜/ä¹°æ–­ï¼‰
- è¯•ç”¨æŒ‰é’®ï¼ˆå¦‚æœæ”¯æŒè¯•ç”¨ï¼‰

### 4. è´­ä¹°åº”ç”¨
ç‚¹å‡»"ç«‹å³è´­ä¹°"æŒ‰é’®ï¼Œå¼¹å‡ºè®¢å•è¡¨å•ï¼š
```
å­—æ®µï¼š
- è®¢é˜…ç±»å‹ï¼ˆæœˆä»˜/å¹´ä»˜/ä¹°æ–­/è¯•ç”¨ï¼‰
- ç”¨æˆ·æ•°é‡ï¼ˆ1-999ï¼‰
- è”ç³»äººå§“å*
- è”ç³»ç”µè¯*ï¼ˆæ‰‹æœºå·éªŒè¯ï¼‰
- è”ç³»é‚®ç®±ï¼ˆé‚®ç®±éªŒè¯ï¼‰
- å…¬å¸åç§°
- æ˜¯å¦éœ€è¦å‘ç¥¨
  - å‘ç¥¨æŠ¬å¤´*
  - çº³ç¨äººè¯†åˆ«å·*
```

### 5. æäº¤è®¢å•
æäº¤ååˆ›å»ºè®¢å•è®°å½•ï¼Œè®¢å•çŠ¶æ€ä¸º `PENDING`ï¼ˆå¾…æ”¯ä»˜ï¼‰

---

## ğŸ”§ å¼€å‘æ‰©å±•

### å¾…å®ç°åŠŸèƒ½ï¼ˆTODOï¼‰

#### 1. æ”¯ä»˜é›†æˆ
```java
// éœ€è¦å®ç°æ”¯ä»˜æ¨¡å—
@PostMapping("/api/system/payment/create")
public Result<PaymentInfo> createPayment(@RequestBody PaymentRequest request) {
    // 1. æŸ¥è¯¢è®¢å•
    AppOrder order = appOrderService.getByOrderNo(request.getOrderNo());
    
    // 2. è°ƒç”¨å¾®ä¿¡/æ”¯ä»˜å®æ”¯ä»˜SDK
    String payUrl = wechatPayService.createNativePay(order);
    
    // 3. è¿”å›æ”¯ä»˜äºŒç»´ç 
    return Result.success(new PaymentInfo(payUrl));
}
```

#### 2. è®¢å•æ”¯ä»˜æˆåŠŸå›è°ƒ
```java
@PostMapping("/api/system/payment/callback")
public String paymentCallback(@RequestBody Map<String, Object> data) {
    // 1. éªŒç­¾
    boolean valid = wechatPayService.verifySignature(data);
    
    // 2. æ›´æ–°è®¢å•çŠ¶æ€ä¸º PAID
    AppOrder order = appOrderService.getByOrderNo(orderNo);
    order.setStatus("PAID");
    order.setPaymentTime(LocalDateTime.now());
    appOrderService.updateById(order);
    
    // 3. åˆ›å»ºè®¢é˜…è®°å½•
    createSubscription(order);
    
    return "SUCCESS";
}
```

#### 3. è‡ªåŠ¨åˆ›å»ºè®¢é˜…
```java
private void createSubscription(AppOrder order) {
    TenantSubscription subscription = new TenantSubscription();
    subscription.setSubscriptionNo(tenantSubscriptionService.generateSubscriptionNo());
    subscription.setTenantId(order.getTenantId());
    subscription.setAppId(order.getAppId());
    subscription.setAppCode(order.getAppCode());
    subscription.setSubscriptionType(order.getSubscriptionType());
    subscription.setStartTime(LocalDateTime.now());
    
    // è®¡ç®—åˆ°æœŸæ—¶é—´
    if ("MONTHLY".equals(order.getSubscriptionType())) {
        subscription.setEndTime(LocalDateTime.now().plusMonths(1));
    } else if ("YEARLY".equals(order.getSubscriptionType())) {
        subscription.setEndTime(LocalDateTime.now().plusYears(1));
    } else if ("PERPETUAL".equals(order.getSubscriptionType())) {
        subscription.setEndTime(null); // æ°¸ä¹…
    }
    
    subscription.setStatus("ACTIVE");
    tenantSubscriptionService.save(subscription);
}
```

#### 4. æƒé™æ§åˆ¶ï¼ˆåŸºäºè®¢é˜…ï¼‰
```java
// åœ¨ç™»å½•æ—¶åŠ è½½ç”¨æˆ·å·²è®¢é˜…çš„åº”ç”¨
@Service
public class TenantPermissionService {
    
    public List<String> getUserSubscribedApps(Long tenantId) {
        QueryWrapper<TenantSubscription> wrapper = new QueryWrapper<>();
        wrapper.eq("tenant_id", tenantId);
        wrapper.eq("status", "ACTIVE");
        wrapper.gt("end_time", LocalDateTime.now()); // æœªè¿‡æœŸ
        
        List<TenantSubscription> subscriptions = tenantSubscriptionService.list(wrapper);
        return subscriptions.stream()
            .map(TenantSubscription::getAppCode)
            .collect(Collectors.toList());
    }
    
    public boolean hasAppPermission(Long tenantId, String appCode) {
        List<String> apps = getUserSubscribedApps(tenantId);
        return apps.contains(appCode);
    }
}
```

#### 5. èœå•åŠ¨æ€æ˜¾ç¤ºï¼ˆæ ¹æ®è®¢é˜…ï¼‰
```java
// å‰ç«¯åœ¨è·¯ç”±å®ˆå«ä¸­æ£€æŸ¥åº”ç”¨æƒé™
router.beforeEach((to, from, next) => {
  const requiredApp = to.meta.requiredApp; // å¦‚ 'PRODUCTION'
  if (requiredApp) {
    const subscribedApps = store.state.user.subscribedApps;
    if (!subscribedApps.includes(requiredApp)) {
      message.error('æ‚¨æœªè®¢é˜…æ­¤åº”ç”¨ï¼Œè¯·å‰å¾€åº”ç”¨å•†åº—è´­ä¹°');
      next('/system/app-store');
      return;
    }
  }
  next();
});
```

---

## ğŸ“ æƒé™é…ç½®

### åç«¯æƒé™ï¼ˆéœ€è¦åœ¨æ•°æ®åº“æ·»åŠ ï¼‰
```sql
-- åº”ç”¨å•†åº—ç›¸å…³æƒé™
INSERT INTO t_permission (permission_code, permission_name, permission_type) VALUES
('MENU_APP_STORE_VIEW', 'æŸ¥çœ‹åº”ç”¨å•†åº—', 'MENU'),
('MENU_APP_STORE_BUY', 'è´­ä¹°åº”ç”¨', 'ACTION'),
('MENU_APP_SUBSCRIPTION_VIEW', 'æŸ¥çœ‹æˆ‘çš„è®¢é˜…', 'MENU'),
('MENU_APP_SUBSCRIPTION_MANAGE', 'ç®¡ç†è®¢é˜…', 'ACTION');

-- åˆ†é…ç»™ç®¡ç†å‘˜è§’è‰²
INSERT INTO t_role_permission (role_id, permission_id)
SELECT 1, id FROM t_permission WHERE permission_code LIKE 'MENU_APP_%';
```

---

## ğŸ‰ åŠŸèƒ½æ¼”ç¤º

### æ“ä½œæ­¥éª¤
```bash
# 1. å¯åŠ¨ç³»ç»Ÿ
cd /Volumes/macoo2/Users/guojunmini4/Documents/æœè£…66666
./dev-public.sh

# 2. ç¼–è¯‘åç«¯ï¼ˆå¦‚æœä»£ç æœ‰ä¿®æ”¹ï¼‰
cd backend
mvn clean compile

# 3. è®¿é—®åº”ç”¨å•†åº—ï¼ˆéœ€è¦å…ˆé…ç½®è·¯ç”±ï¼‰
æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:5173/system/app-store
```

### æµ‹è¯•æ•°æ®åº“
```bash
# æŸ¥çœ‹åº”ç”¨åˆ—è¡¨
docker exec fashion-mysql-simple mysql -uroot -pchangeme fashion_supplychain \
  -e "SELECT * FROM t_app_store WHERE status='PUBLISHED' ORDER BY sort_order;"

# æŸ¥çœ‹è®¢å•è®°å½•
docker exec fashion-mysql-simple mysql -uroot -pchangeme fashion_supplychain \
  -e "SELECT order_no, app_name, total_amount, status FROM t_app_order;"

# æŸ¥çœ‹è®¢é˜…è®°å½•
docker exec fashion-mysql-simple mysql -uroot -pchangeme fashion_supplychain \
  -e "SELECT subscription_no, app_name, status, start_time, end_time FROM t_tenant_subscription;"
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰
- [ ] é…ç½®å‰ç«¯è·¯ç”±ï¼ˆå°†åº”ç”¨å•†åº—åŠ å…¥èœå•ï¼‰
- [ ] å®ç°æ”¯ä»˜æ¨¡å—ï¼ˆå¾®ä¿¡æ”¯ä»˜/æ”¯ä»˜å®ï¼‰
- [ ] è®¢å•æ”¯ä»˜æˆåŠŸåè‡ªåŠ¨åˆ›å»ºè®¢é˜…
- [ ] æˆ‘çš„è®¢é˜…é¡µé¢ï¼ˆæŸ¥çœ‹å·²è´­ä¹°åº”ç”¨ï¼‰

### ä¸­æœŸï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] æƒé™æ§åˆ¶ï¼ˆæ ¹æ®è®¢é˜…åŠ¨æ€æ˜¾ç¤ºèœå•ï¼‰
- [ ] è®¢é˜…ç»­è´¹åŠŸèƒ½
- [ ] è®¢é˜…å‡çº§/é™çº§
- [ ] å‘ç¥¨ç®¡ç†

### é•¿æœŸï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] ä¼˜æƒ åˆ¸/ä¿ƒé”€æ´»åŠ¨
- [ ] æ¨èå¥–åŠ±æœºåˆ¶
- [ ] åº”ç”¨ä½¿ç”¨ç»Ÿè®¡
- [ ] è‡ªåŠ¨æ‰£è´¹ï¼ˆé“¶è¡Œå¡ç»‘å®šï¼‰

---

## ğŸ“š ç›¸å…³æ–‡ä»¶ä½ç½®

### æ•°æ®åº“SQL
- `/backend/sql/V20260210__app_store.sql` - åº”ç”¨å•†åº—å»ºè¡¨SQL

### åç«¯ä»£ç 
- `/backend/src/main/java/com/fashion/supplychain/system/`
  - `entity/AppStore.java` - åº”ç”¨å®ä½“
  - `entity/TenantSubscription.java` - è®¢é˜…å®ä½“
  - `entity/AppOrder.java` - è®¢å•å®ä½“
  - `mapper/AppStoreMapper.java` - æ•°æ®è®¿é—®å±‚
  - `service/AppStoreService.java` - ä¸šåŠ¡é€»è¾‘å±‚
  - `controller/AppStoreController.java` - API æ§åˆ¶å™¨

### å‰ç«¯ä»£ç 
- `/frontend/src/modules/system/pages/AppStore/`
  - `index.tsx` - åº”ç”¨å•†åº—é¡µé¢ç»„ä»¶
  - `index.css` - æ ·å¼æ–‡ä»¶
- `/frontend/src/services/system/appStore.ts` - API æœåŠ¡å±‚

---

## ğŸ’¡ è®¾è®¡ç†å¿µ

### ä¸ºä»€ä¹ˆé€‰æ‹©åº”ç”¨å•†åº—æ¨¡å¼ï¼Ÿ
1. **çµæ´»è®¢é˜…**ï¼šä¼ä¸šæŒ‰éœ€è´­ä¹°ï¼Œé™ä½åˆæœŸæˆæœ¬
2. **å¯æ‰©å±•æ€§**ï¼šæ–°åŠŸèƒ½ä½œä¸ºæ–°åº”ç”¨ä¸Šæ¶
3. **å•†ä¸šåŒ–**ï¼šæ¸…æ™°çš„æ”¶è´¹æ¨¡å¼ï¼Œåˆ©äºè¿è¥
4. **ç§Ÿæˆ·éš”ç¦»**ï¼šå¤šç§Ÿæˆ·æ¶æ„ï¼Œæ•°æ®å®‰å…¨éš”ç¦»

### å‚è€ƒäº§å“
- ä¼ä¸šå¾®ä¿¡åº”ç”¨å¸‚åœº
- é’‰é’‰åº”ç”¨ä¸­å¿ƒ
- Shopify åº”ç”¨å•†åº—
- Salesforce AppExchange

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æƒé™é…ç½®**ï¼šéœ€è¦åœ¨æ•°æ®åº“æ·»åŠ åº”ç”¨å•†åº—ç›¸å…³æƒé™
2. **è·¯ç”±é…ç½®**ï¼šéœ€è¦åœ¨å‰ç«¯è·¯ç”±ä¸­æ·»åŠ åº”ç”¨å•†åº—å…¥å£
3. **æ”¯ä»˜é›†æˆ**ï¼šç›®å‰ä»…åˆ›å»ºè®¢å•ï¼Œæœªé›†æˆçœŸå®æ”¯ä»˜
4. **ç§Ÿæˆ·ID**ï¼šå½“å‰ç¡¬ç¼–ç ï¼Œéœ€æ”¹ä¸ºä» UserContext è·å–
5. **è®¢é˜…æ¿€æ´»**ï¼šè®¢å•æ”¯ä»˜æˆåŠŸåéœ€è‡ªåŠ¨åˆ›å»ºè®¢é˜…è®°å½•

---

**å®ç°å®Œæˆåº¦**ï¼š70%ï¼ˆæ•°æ®åº“ âœ… + åç«¯ âœ… + å‰ç«¯ âœ…ï¼Œå¾…å®Œæˆï¼šæ”¯ä»˜ + æƒé™ï¼‰
**é¢„è®¡å¼€å‘å·¥æ—¶**ï¼šæ”¯ä»˜é›†æˆ 2å¤© + æƒé™æ§åˆ¶ 1å¤© + æµ‹è¯• 1å¤© = 4å¤©
**å•†ä¸šä»·å€¼**ï¼šâ˜…â˜…â˜…â˜…â˜…ï¼ˆæ ¸å¿ƒå•†ä¸šåŒ–åŠŸèƒ½ï¼‰
